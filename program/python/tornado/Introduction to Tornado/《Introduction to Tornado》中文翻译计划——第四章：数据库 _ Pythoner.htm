<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0032)http://www.pythoner.com/283.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<title>《Introduction to Tornado》中文翻译计划——第四章：数据库 | Pythoner</title>
<meta name="description" content="你像从前一样的Python学习笔记">

<link rel="alternate" type="application/rss+xml" title="Pythoner RSS Feed" href="http://www.pythoner.com/feed">
<link rel="alternate" type="application/atom+xml" title="Pythoner Atom Feed" href="http://www.pythoner.com/feed/atom"> 
<link rel="pingback" href="http://www.pythoner.com/xmlrpc.php">

<link rel="stylesheet" href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/style.css" type="text/css">
<link rel="stylesheet" href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/comment-style.css" type="text/css">

 
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Pythoner » 《Introduction to Tornado》中文翻译计划——第四章：数据库评论Feed" href="http://www.pythoner.com/283.html/feed">
		<script type="text/javascript" async="" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/ga.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.pythoner.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-son-of-obsidian-css" href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/son-of-obsidian.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/monaco.css" type="text/css" media="all">
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jquery.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/www.pythoner.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"\u4f7f\u7528 %s \u590d\u5236\uff0c\u4f7f\u7528 %s \u7c98\u8d34\u3002","minimize":"\u70b9\u51fb\u5c55\u5f00\u4ee3\u7801"};
/* ]]> */
</script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/crayon.min.js"></script>
<link rel="https://api.w.org/" href="http://www.pythoner.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.pythoner.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.pythoner.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="《Introduction to Tornado》中文翻译计划——第三章：模板扩展" href="http://www.pythoner.com/282.html">
<link rel="next" title="《Introduction to Tornado》中文翻译计划——第五章：异步Web服务" href="http://www.pythoner.com/294.html">
<meta name="generator" content="WordPress 4.6.1">
<link rel="shortlink" href="http://www.pythoner.com/?p=283">
<link rel="alternate" type="application/json+oembed" href="http://www.pythoner.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.pythoner.com%2F283.html">
<link rel="alternate" type="text/xml+oembed" href="http://www.pythoner.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.pythoner.com%2F283.html&amp;format=xml">
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-37612759-1']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script type="text/javascript">
	window._wp_rp_static_base_url = 'https://wprp.zemanta.com/static/';
	window._wp_rp_wp_ajax_url = "http://www.pythoner.com/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '3.6.1';
	window._wp_rp_post_id = '283';
	window._wp_rp_num_rel_posts = '5';
	window._wp_rp_thumbnails = false;
	window._wp_rp_post_title = '%E3%80%8AIntroduction+to+Tornado%E3%80%8B%E4%B8%AD%E6%96%87%E7%BF%BB%E8%AF%91%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93';
	window._wp_rp_post_tags = ['python', 'github', '%3F%3F', 'tornado', 'tornado', 'introduct', 'doc', 'properti', 'tornado', '4', 'insert', 'pre', 'widget', 'conn', 'print', 'extern', 'db', 'quantiti', 'save', 'industri'];
	window._wp_rp_promoted_content = true;
</script>
<style type="text/css">
.related_post_title {
  margin: 40px 0 10px !important;
  color: #333 !important;
}
ul.related_post {
}
ul.related_post li {
}
ul.related_post li a {
}
ul.related_post li img {
}</style>
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jscript.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/comment.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/rollover.js"></script>

<!--[if IE 7]>
<link rel="stylesheet" href="http://www.pythoner.com/wp-content/themes/flat/ie7.css" type="text/css" />
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="http://www.pythoner.com/wp-content/themes/flat/ie8.css" type="text/css" />
<![endif]-->


<style type="text/css">
a, .post .title a:hover, .post_meta a:hover, #bread_crumb ul li a:hover, #previous_post a:hover, #next_post a:hover, .post a.more-link:hover, #right_col li a:hover, #copyright li a:hover, #archive_headline #keyword,
   #comments_wrapper a:hover, #comment_header_right .comment_switch_active a, #comment_header_right .comment_switch_active a:hover, #comment_pager .current
   { color:#00A19E; }

#no_post a.back:hover, #wp-calendar td a:hover, #wp-calendar #prev a:hover, #wp-calendar #next a:hover, .page_navi a:hover, #submit_comment:hover
 { background-color:#00A19E; }

#guest_info input:focus, #comment_textarea textarea:focus
 { border:1px solid #00A19E; }

a:hover
 { color:#BDC900; }

body { font-size:13px; }



</style>

<link href="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/bdsstyle.css" rel="stylesheet" type="text/css"><script src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/logger.js"></script></head>

<body><iframe frameborder="0" style="display: none;" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/saved_resource.html"></iframe><div id="bdshare_s" style="display: block;"><iframe id="bdsIfr" style="position:absolute;display:none;z-index:9999;" frameborder="0" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/saved_resource(1).html"></iframe><div id="bdshare_l" style="display: none;"><div id="bdshare_l_c"><h6>分享到</h6><ul><li><a href="http://www.pythoner.com/283.html#" class="bds_mshare mshare">一键分享</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_qzone qqkj">QQ空间</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsina xlwb">新浪微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdysc bdysc">百度云收藏</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_renren rrw">人人网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqq txwb">腾讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdxc bdxc">百度相册</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_kaixin001 kxw">开心网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqf txpy">腾讯朋友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tieba bdtb">百度贴吧</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_douban db">豆瓣网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsohu shwb">搜狐微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdhome bdhome">百度新首页</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_sqq sqq">QQ好友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_thx thx">和讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_more">更多...</a></li></ul><p><a href="http://www.pythoner.com/283.html#" class="goWebsite">百度分享</a></p></div></div></div><div id="bdshare_s" style="display: block;"><iframe id="bdsIfr" style="position:absolute;display:none;z-index:9999;" frameborder="0" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/saved_resource(2).html"></iframe><div id="bdshare_l" style="display: none;"><div id="bdshare_l_c"><h6>分享到</h6><ul><li><a href="http://www.pythoner.com/283.html#" class="bds_mshare mshare">一键分享</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_qzone qqkj">QQ空间</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsina xlwb">新浪微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdysc bdysc">百度云收藏</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_renren rrw">人人网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqq txwb">腾讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdxc bdxc">百度相册</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_kaixin001 kxw">开心网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqf txpy">腾讯朋友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tieba bdtb">百度贴吧</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_douban db">豆瓣网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsohu shwb">搜狐微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdhome bdhome">百度新首页</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_sqq sqq">QQ好友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_thx thx">和讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_more">更多...</a></li></ul><p><a href="http://www.pythoner.com/283.html#" class="goWebsite">百度分享</a></p></div></div></div><div id="bdshare_s" style="display: block;"><iframe id="bdsIfr" style="position:absolute;display:none;z-index:9999;" frameborder="0" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/saved_resource(3).html"></iframe><div id="bdshare_l" style="display: none;"><div id="bdshare_l_c"><h6>分享到</h6><ul><li><a href="http://www.pythoner.com/283.html#" class="bds_mshare mshare">一键分享</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_qzone qqkj">QQ空间</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsina xlwb">新浪微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdysc bdysc">百度云收藏</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_renren rrw">人人网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqq txwb">腾讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdxc bdxc">百度相册</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_kaixin001 kxw">开心网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tqf txpy">腾讯朋友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tieba bdtb">百度贴吧</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_douban db">豆瓣网</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_tsohu shwb">搜狐微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_bdhome bdhome">百度新首页</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_sqq sqq">QQ好友</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_thx thx">和讯微博</a></li><li><a href="http://www.pythoner.com/283.html#" class="bds_more">更多...</a></li></ul><p><a href="http://www.pythoner.com/283.html#" class="goWebsite">百度分享</a></p></div></div></div>

 <div id="header">
  <div class="header_menu">
    <ul id="menu-nav" class="menu"><li id="menu-item-29" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-29"><a href="http://www.pythoner.com/category/programming-language/python">Python</a></li>
<li id="menu-item-28" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-28"><a href="http://www.pythoner.com/category/note">读书笔记</a></li>
<li id="menu-item-47" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-47"><a href="http://www.pythoner.com/about">About</a></li>
</ul>    </div>
  <!-- logo -->
  <h1 class="logo_text"><a href="http://www.pythoner.com/">Pythoner</a></h1>
<h2 id="site_description">你像从前一样的Python学习笔记</h2>
 </div>

 <div id="main_content" class="clearfix">

  <div id="left_col">
      <div id="bread_crumb">
    <ul class="clearfix">
     <li id="bc_home"><a href="http://www.pythoner.com/" title="首页">首页</a></li>
     <li id="bc_cat"><a href="http://www.pythoner.com/category/programming-language">编程语言</a><a href="http://www.pythoner.com/category/programming-language/python">python</a><a href="http://www.pythoner.com/category/programming-language/python/tornado">Tornado</a></li>     <li class="last">《Introduction to Tornado》中文翻译计划——第四章：数据库</li>
    </ul>
   </div>
   
   
   <div class="post_wrap clearfix" id="single">
    <div class="post">
     <h3 class="title"><span>《Introduction to Tornado》中文翻译计划——第四章：数据库</span></h3>
     <div class="post_content">
      <div class="post_baidushare_up clearfix">
       <!-- Baidu Button BEGIN -->
       <div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare">
       <a class="bds_tsina" title="分享到新浪微博" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_renren" title="分享到人人网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_tqq" title="分享到腾讯微博" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_qzone" title="分享到QQ空间" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_douban" title="分享到豆瓣网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_diandian" title="分享到点点网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_twi" title="分享到Twitter" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_fbook" title="分享到Facebook" href="http://www.pythoner.com/283.html#"></a>
       <span class="bds_more">更多</span>
       <a class="shareCount" href="http://www.pythoner.com/283.html#" title="累计分享1次">1</a>
       </div>
       <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1482744" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/bds_s_v2.js"></script>
       
       <script type="text/javascript">
       document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
       </script>
       <!-- Baidu Button END -->
      </div>
      <p>本文为《Introduction to Tornado》中文翻译，将在<a href="https://github.com/alioth310/itt2zh" title="Introduction  to Tornado 中文翻译" target="_blank">https://github.com/alioth310/itt2zh</a>上面持续更新，本文内容可能不是最新状态，请在GitHub上获得最新版本。</p>
<p>本文也可在<a href="http://demo.pythoner.com/itt2zh">http://demo.pythoner.com/itt2zh</a>上进行格式化的预览。</p>
<p><strong>第四章：数据库</strong></p>
<p>在本章中，我们将给出几个使用数据库的Tornado Web应用的例子。我们将从一个简单的RESTful API例子起步，然后创建3.1.2节中的Burt’s Book网站的完整功能版本。</p>
<p>本章中的例子使用MongoDB作为数据库，并通过pymongo作为驱动来连接MongoDB。当然，还有很多数据库系统可以用在Web应用中：Redis、CouchDB和MySQL都是一些知名的选择，并且Tornado自带处理MySQL请求的库。我们选择使用MongoDB是因为它的简单性和便捷性：安装简单，并且能够和Python代码很好地融合。它结构自然，预定义数据结构不是必需的，很适合原型开发。<br>
<span id="more-283"></span><br>
在本章中，我们假设你已经在机器上安装了MongoDB，能够运行示例代码，不过也可以在远程服务器上使用MongoDB，相关的代码调整也很容易。如果你不想在你的机器上安装MongoDB，或者没有一个适合你操作系统的MongoDB版本，你也可以选择一些MongoDB主机服务。我们推荐使用<a href="http://www.mongohq.com/" target="_blank">MongoHQ</a>。在我们最初的例子中，假设你已经在你的机器上运行了MongoDB，但使用远程服务器（包括MongoHQ）运行的MongoDB时，调整代码也很简单。</p>
<p>我们同样还假设你已经有一些数据库的经验了，尽管并不一定是特定的MongoDB数据库的经验。当然，我们只会使用MongoDB的一点皮毛；如果想获得更多信息请查阅MongoDB文档（<a href="http://www.mongodb.org/display/DOCS/Home" target="_blank">http://www.mongodb.org/display/DOCS/Home</a>）让我们开始吧！</p>
<h1>4.1 使用PyMongo进行MongoDB基础操作</h1>
<p>在我们使用MongoDB编写Web应用之前，我们需要了解如何在Python中使用MongoDB。在这一节，你将学会如何使用PyMongo连接MongoDB数据库，然后学习如何使用pymongo在MongoDB集合中创建、取出和更新文档。</p>
<p>PyMongo是一个简单的包装MongoDB客户端API的Python库。你可以在<a href="http://api.mongodb.org/python/current/" target="_blank">http://api.mongodb.org/python/current/</a>下载获得。一旦你安装完成，打开一个Python解释器，然后跟随下面的步骤。</p>
<h2>4.1.1 创建连接</h2>
<p>首先，你需要导入PyMongo库，并创建一个到MongoDB数据库的连接。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29047258255549" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; import pymongo
&gt;&gt;&gt; conn = pymongo.Connection("localhost", 27017)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29047258255549-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29047258255549-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29047258255549-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29047258255549-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p> </p>
<p>前面的代码向我们展示了如何连接运行在你本地机器上默认端口（27017）上的MongoDB服务器。如果你正在使用一个远程MongoDB服务器，替换localhost和27017为合适的值。你也可以使用MongoDB URI来连接MongoDB，就像下面这样：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29080952328471" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; conn = pymongo.Connection(
... "mongodb://user:password@staff.mongohq.com:10066/your_mongohq_db")</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29080952328471-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29080952328471-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29080952328471-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29080952328471-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">"mongodb://user:password@staff.mongohq.com:10066/your_mongohq_db"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p> </p>
<p>前面的代码将连接MongoHQ主机上的一个名为your_mongohq_db的数据库，其中user为用户名，password为密码。你可以在<a href="http://www.mongodb.org/display/DOCS/Connections" target="_blank">http://www.mongodb.org/display/DOCS/Connections</a>中了解更多关于MongoDB URI的信息。</p>
<p>一个MongoDB服务器可以包括任意数量的数据库，而Connection对象可以让你访问你连接的服务器的任何一个数据库。你可以通过对象属性或像字典一样使用对象来获得代表一个特定数据库的对象。如果数据库不存在，则被自动建立。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29093536338797" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; db = conn.example or: db = conn['example']</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29093536338797-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29093536338797-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-e">example </span><span class="crayon-st">or</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">'example'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p> </p>
<p>一个数据库可以拥有任意多个集合。一个集合就是放置一些相关文档的地方。我们使用MongoDB执行的大部分操作（查找文档、保存文档、删除文档）都是在一个集合对象上执行的。你可以在数据库对象上调用collection_names方法获得数据库中的集合列表。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2909b267203699" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; db.collection_names()
[]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2909b267203699-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2909b267203699-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2909b267203699-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">collection_names</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2909b267203699-2"><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p> </p>
<p>当然，我们还没有在我们的数据库中添加任何集合，所以这个列表是空的。当我们插入第一个文档时，MongoDB会自动创建集合。你可以在数据库对象上通过访问集合名字的属性来获得代表集合的对象，然后调用对象的insert方法指定一个Python字典来插入文档。比如，在下面的代码中，我们在集合widgets中插入了一个文档。因为widgets集合并不存在，MongoDB会在文档被添加时自动创建。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290a2216634988" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; widgets = db.widgets or: widgets = db['widgets'] (see below)
&gt;&gt;&gt; widgets.insert({"foo": "bar"})
ObjectId('4eada0b5136fc4aa41000000')
&gt;&gt;&gt; db.collection_names()
[u'widgets', u'system.indexes']</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290a2216634988-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290a2216634988-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290a2216634988-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290a2216634988-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290a2216634988-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290a2216634988-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">widgets </span><span class="crayon-st">or</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">[</span><span class="crayon-s">'widgets'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">see </span><span class="crayon-v">below</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290a2216634988-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"foo"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"bar"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290a2216634988-3"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada0b5136fc4aa41000000'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290a2216634988-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">collection_names</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290a2216634988-5"><span class="crayon-sy">[</span><span class="crayon-i">u</span><span class="crayon-s">'widgets'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'system.indexes'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p> </p>
<p>（system.indexes集合是MongoDB内部使用的。处于本章的目的，你可以忽略它。）</p>
<p>在之前展示的代码中，你既可以使用数据库对象的属性访问集合，也可以把数据库对象看作一个字典然后把集合名称作为键来访问。比如，如果db是一个pymongo数据库对象，那么db.widgets和db[‘widgets’]同样都可以访问这个集合。</p>
<h2>4.1.2 处理文档</h2>
<p>MongoDB以文档的形式存储数据，这种形式有着相对自由的数据结构。MongoDB是一个”无模式”数据库：同一个集合中的文档通常拥有相同的结构，但是MongoDB中并不强制要求使用相同结构。在内部，MongoDB以一种称为BSON的类似JSON的二进制形式存储文档。PyMongo允许我们以Python字典的形式写和取出文档。</p>
<p>为了在集合中 创建一个新的文档，我们可以使用字典作为参数调用文档的insert方法。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290a9136799592" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; widgets.insert({"name": "flibnip", "description": "grade-A industrial flibnip", "quantity": 3})
ObjectId('4eada3a4136fc4aa41000001')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290a9136799592-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290a9136799592-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290a9136799592-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"grade-A industrial flibnip"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"quantity"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290a9136799592-2"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada3a4136fc4aa41000001'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p> </p>
<p>既然文档在数据库中，我们可以使用集合对象的find_one方法来取出文档。你可以通过传递一个键为文档名、值为你想要匹配的表达式的字典来告诉find_one找到 一个特定的文档。比如，我们想要返回文档名域name的值等于flibnip的文档（即，我们刚刚创建的文档），可以像下面这样调用find_oen方法：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290b9370329535" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; widgets.find_one({"name": "flibnip"})
{u'description': u'grade-A industrial flibnip',
 u'_id': ObjectId('4eada3a4136fc4aa41000001'),
 u'name': u'flibnip', u'quantity': 3}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290b9370329535-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290b9370329535-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290b9370329535-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290b9370329535-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290b9370329535-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290b9370329535-2"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'grade-A industrial flibnip'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290b9370329535-3"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada3a4136fc4aa41000001'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290b9370329535-4"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'flibnip'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p> </p>
<p>请注意_id域。当你创建任何文档时，MongoDB都会自动添加这个域。它的值是一个ObjectID，一种保证文档唯一的BSON对象。你可能已经注意到，当我们使用insert方法成功创建一个新的文档时，这个ObjectID同样被返回了。（当你创建文档时，可以通过给_id键赋值来覆写自动创建的ObjectID值。）</p>
<p>find_one方法返回的值是一个简单的Python字典。你可以从中访问独立的项，迭代它的键值对，或者就像使用其他Python字典那样修改值。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290c2383761095" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; doc = db.widgets.find_one({"name": "flibnip"})
&gt;&gt;&gt; type(doc)
&lt;type 'dict'&gt;
&gt;&gt;&gt; print doc['name']
flibnip
&gt;&gt;&gt; doc['quantity'] = 4</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290c2383761095-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c2383761095-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290c2383761095-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c2383761095-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290c2383761095-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c2383761095-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290c2383761095-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c2383761095-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290c2383761095-3"><span class="crayon-o">&lt;</span><span class="crayon-k ">type</span><span class="crayon-h"> </span><span class="crayon-s">'dict'</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c2383761095-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57ee2c4b290c2383761095-5"><span class="crayon-v">flibnip</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c2383761095-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-s">'quantity'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p> </p>
<p>然而，字典的改变并不会自动保存到数据库中。如果你希望把字典的改变保存，需要调用集合的save方法，并将修改后的字典作为参数进行传递：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290c8451279921" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; doc['quantity'] = 4
&gt;&gt;&gt; db.widgets.save(doc)
&gt;&gt;&gt; db.widgets.find_one({"name": "flibnip"})
{u'_id': ObjectId('4eb12f37136fc4b59d000000'),
 u'description': u'grade-A industrial flibnip',
 u'quantity': 4, u'name': u'flibnip'}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290c8451279921-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c8451279921-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290c8451279921-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c8451279921-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290c8451279921-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290c8451279921-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290c8451279921-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-s">'quantity'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c8451279921-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290c8451279921-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c8451279921-4"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb12f37136fc4b59d000000'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290c8451279921-5"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'grade-A industrial flibnip'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290c8451279921-6"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'flibnip'</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p> </p>
<p>让我们在集合中添加更多的文档：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290cf886907946" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; widgets.insert({"name": "smorkeg", "description": "for external use only", "quantity": 4})
ObjectId('4eadaa5c136fc4aa41000002')
&gt;&gt;&gt; widgets.insert({"name": "clobbasker", "description": "properties available on request", "quantity": 2})
ObjectId('4eadad79136fc4aa41000003')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290cf886907946-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290cf886907946-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290cf886907946-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290cf886907946-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290cf886907946-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"smorkeg"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"for external use only"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"quantity"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290cf886907946-2"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadaa5c136fc4aa41000002'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290cf886907946-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"clobbasker"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"properties available on request"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"quantity"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290cf886907946-4"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadad79136fc4aa41000003'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
<p> </p>
<p>我们可以通过调用集合的find方法来获得集合中所有文档的列表，然后迭代其结果：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290d6890729252" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; for doc in widgets.find():
...     print doc
...
{u'_id': ObjectId('4eada0b5136fc4aa41000000'), u'foo': u'bar'}
{u'description': u'grade-A industrial flibnip',
 u'_id': ObjectId('4eada3a4136fc4aa41000001'),
 u'name': u'flibnip', u'quantity': 4}
{u'description': u'for external use only',
 u'_id': ObjectId('4eadaa5c136fc4aa41000002'),
 u'name': u'smorkeg', u'quantity': 4}
{u'description': u'properties available on request',
 u'_id': ObjectId('4eadad79136fc4aa41000003'),
 u'name': u'clobbasker',
 u'quantity': 2}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b290d6890729252-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290d6890729252-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">doc </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-i">doc</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-4"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada0b5136fc4aa41000000'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'foo'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'bar'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-5"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'grade-A industrial flibnip'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-6"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada3a4136fc4aa41000001'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-7"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'flibnip'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-8"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'for external use only'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-9"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadaa5c136fc4aa41000002'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-10"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'smorkeg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-11"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'properties available on request'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-12"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadad79136fc4aa41000003'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290d6890729252-13"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'clobbasker'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290d6890729252-14"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0056 seconds] -->
<p> </p>
<p>如果我们希望获得文档的一个子集，我们可以在find方法中传递一个字典参数，就像我们在find_one中那样。比如，找到那些quantity键的值为4的集合：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290dc035869616" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; for doc in widgets.find({"quantity": 4}):
...     print doc
...
{u'description': u'grade-A industrial flibnip',
 u'_id': ObjectId('4eada3a4136fc4aa41000001'),
 u'name': u'flibnip', u'quantity': 4}
{u'description': u'for external use only',
 u'_id': ObjectId('4eadaa5c136fc4aa41000002'),
 u'name': u'smorkeg',
 u'quantity': 4}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290dc035869616-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290dc035869616-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290dc035869616-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290dc035869616-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290dc035869616-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290dc035869616-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b290dc035869616-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290dc035869616-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b290dc035869616-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290dc035869616-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290dc035869616-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">doc </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"quantity"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290dc035869616-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-i">doc</span></div><div class="crayon-line" id="crayon-57ee2c4b290dc035869616-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290dc035869616-4"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'grade-A industrial flibnip'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290dc035869616-5"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada3a4136fc4aa41000001'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290dc035869616-6"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'flibnip'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b290dc035869616-7"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'for external use only'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290dc035869616-8"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadaa5c136fc4aa41000002'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290dc035869616-9"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'smorkeg'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290dc035869616-10"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p> </p>
<p>最后，我们可以使用集合的remove方法从集合中删除一个文档。remove方法和find、find_one一样，也可以使用一个字典参数来指定哪个文档需要被删除。比如，要删除所有name键的值为flipnip的文档，输入：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290e6523562847" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; widgets.remove({"name": "flibnip"})</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290e6523562847-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290e6523562847-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p> </p>
<p>列出集合中的所有文档来确认上面的文档已经被删除：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290ed166151178" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; for doc in widgets.find():
...     print doc
...
{u'_id': ObjectId('4eada0b5136fc4aa41000000'),
 u'foo': u'bar'}
{u'description': u'for external use only',
 u'_id': ObjectId('4eadaa5c136fc4aa41000002'),
 u'name': u'smorkeg', u'quantity': 4}
{u'description': u'properties available on request',
 u'_id': ObjectId('4eadad79136fc4aa41000003'),
 u'name': u'clobbasker',
 u'quantity': 2}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b290ed166151178-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290ed166151178-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">doc </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-i">doc</span></div><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-4"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eada0b5136fc4aa41000000'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-5"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'foo'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'bar'</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-6"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'for external use only'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-7"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadaa5c136fc4aa41000002'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-8"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'smorkeg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-9"><span class="crayon-sy">{</span><span class="crayon-i">u</span><span class="crayon-s">'description'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'properties available on request'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-10"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'_id'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eadad79136fc4aa41000003'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b290ed166151178-11"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'clobbasker'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290ed166151178-12"><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0045 seconds] -->
<p> </p>
<h2>4.1.3 MongoDB文档和JSON</h2>
<p>使用Web应用时，你经常会想采用Python字典并将其序列化为一个JSON对象（比如，作为一个AJAX请求的响应）。由于你使用PyMongo从MongoDB中取出的文档是一个简单的字典，你可能会认为你可以使用json模块的dumps函数就可以简单地将其转换为JSON。但，这还有一个障碍：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290f4884834749" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; doc = db.widgets.find_one({"name": "flibnip"})
&gt;&gt;&gt; import json
&gt;&gt;&gt; json.dumps(doc)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
    [stack trace omitted]
TypeError: ObjectId('4eb12f37136fc4b59d000000') is not JSON serializable</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290f4884834749-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290f4884834749-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290f4884834749-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290f4884834749-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b290f4884834749-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290f4884834749-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b290f4884834749-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290f4884834749-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">widgets</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"name"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"flibnip"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290f4884834749-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">json</span></div><div class="crayon-line" id="crayon-57ee2c4b290f4884834749-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">dumps</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290f4884834749-4"><span class="crayon-k ">Traceback</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">most </span><span class="crayon-e">recent </span><span class="crayon-e">call </span><span class="crayon-v">last</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b290f4884834749-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">File</span><span class="crayon-h"> </span><span class="crayon-s">"&lt;stdin&gt;"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">line</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-v">module</span><span class="crayon-o">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290f4884834749-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-e">stack </span><span class="crayon-k ">trace</span><span class="crayon-h"> </span><span class="crayon-v">omitted</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57ee2c4b290f4884834749-7"><span class="crayon-k ">TypeError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb12f37136fc4b59d000000'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-k ">JSON</span><span class="crayon-h"> </span><span class="crayon-v">serializable</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p> </p>
<p>这里的问题是Python的json模块并不知道如何转换MongoDB的ObjectID类型到JSON。有很多方法可以处理这个问题。其中最简单的方法（也是我们在本章中采用的方法）是在我们序列化之前从字典里简单地删除_id键。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b290fa984387764" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; del doc["_id"]
&gt;&gt;&gt; json.dumps(doc)
'{"description": "grade-A industrial flibnip", "quantity": 4, "name": "flibnip"}'</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b290fa984387764-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b290fa984387764-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b290fa984387764-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b290fa984387764-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b290fa984387764-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-k ">json</span><span class="crayon-sy">.</span><span class="crayon-e">dumps</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b290fa984387764-3"><span class="crayon-s">'{"description": "grade-A industrial flibnip", "quantity": 4, "name": "flibnip"}'</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p> </p>
<p>一个更复杂的方法是使用PyMongo的json_util库，它同样可以帮你序列化其他MongoDB特定数据类型到JSON。我们可以在<a href="http://api.mongodb.org/python/current/api/bson/json_util.html" target="_blank">http://api.mongodb.org/python/current/api/bson/json_util.html</a>了解更多关于这个库的信息。</p>
<h1>4.2 一个简单的持久化Web服务</h1>
<p>现在我们知道编写一个Web服务，可以访问MongoDB数据库中的数据。首先，我们要编写一个只从MongoDB读取数据的Web服务。然后，我们写一个可以读写数据的服务。</p>
<h2>4.2.1 只读字典</h2>
<p>我们将要创建的应用是一个基于Web的简单字典。你发送一个指定单词的请求，然后返回这个单词的定义。一个典型的交互看起来是下面这样的：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29101112441826" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl http://localhost:8000/oarlock
{definition: "A device attached to a rowboat to hold the oars in place",
"word": "oarlock"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29101112441826-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29101112441826-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b29101112441826-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29101112441826-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">curl </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">oarlock</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29101112441826-2"><span class="crayon-sy">{</span><span class="crayon-v">definition</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"A device attached to a rowboat to hold the oars in place"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29101112441826-3"><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"oarlock"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p> </p>
<p>这个Web服务将从MongoDB数据库中取得数据。具体来说，我们将根据word属性查询文档。在我们查看Web应用本身的源码之前，先让我们从Python解释器中向数据库添加一些单词。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29107627527279" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; import pymongo
&gt;&gt;&gt; conn = pymongo.Connection("localhost", 27017)
&gt;&gt;&gt; db = conn.example
&gt;&gt;&gt; db.words.insert({"word": "oarlock", "definition": "A device attached to a rowboat to hold the oars in place"})
ObjectId('4eb1d1f8136fc4be90000000')
&gt;&gt;&gt; db.words.insert({"word": "seminomadic", "definition": "Only partial
ly nomadic"})
ObjectId('4eb1d356136fc4be90000001')
&gt;&gt;&gt; db.words.insert({"word": "perturb", "definition": "Bother, unsettle
, modify"})
ObjectId('4eb1d39d136fc4be90000002')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29107627527279-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29107627527279-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29107627527279-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29107627527279-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29107627527279-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b29107627527279-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29107627527279-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29107627527279-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29107627527279-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">.</span><span class="crayon-v">example</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29107627527279-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">words</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"oarlock"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"A device attached to a rowboat to hold the oars in place"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29107627527279-5"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb1d1f8136fc4be90000000'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29107627527279-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">words</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"seminomadic"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Only partial</span></div><div class="crayon-line" id="crayon-57ee2c4b29107627527279-7"><span class="crayon-s">ly nomadic"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29107627527279-8"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb1d356136fc4be90000001'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29107627527279-9"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">words</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"perturb"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Bother, unsettle</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29107627527279-10"><span class="crayon-s">, modify"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29107627527279-11"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb1d39d136fc4be90000002'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0051 seconds] -->
<p> </p>
<p>代码清单4-1是我们这个词典Web服务的源码，在这个代码中我们查询刚才添加的单词然后使用其定义作为响应。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2910e761011029" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">代码清单4-1 一个词典Web服务：definitions_readonly.py</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web

import pymongo

from tornado.options import define, options
define("port", default=8000, help="run on the given port", type=int)

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [(r"/(\w+)", WordHandler)]
        conn = pymongo.Connection("localhost", 27017)
        self.db = conn["example"]
        tornado.web.Application.__init__(self, handlers, debug=True)

class WordHandler(tornado.web.RequestHandler):
    def get(self, word):
        coll = self.application.db.words
        word_doc = coll.find_one({"word": word})
        if word_doc:
            del word_doc["_id"]
            self.write(word_doc)
        else:
            self.set_status(404)
            self.write({"error": "word not found"})

if __name__ == "__main__":
    tornado.options.parse_command_line()
    http_server = tornado.httpserver.HTTPServer(Application())
    http_server.listen(options.port)
    tornado.ioloop.IOLoop.instance().start()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-24">24</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-26">26</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-28">28</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-30">30</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2910e761011029-32">32</div><div class="crayon-num" data-line="crayon-57ee2c4b2910e761011029-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">httpserver</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">ioloop</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">web</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pymongo</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-8"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">define</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">options</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-9"><span class="crayon-e">define</span><span class="crayon-sy">(</span><span class="crayon-s">"port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">8000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"run on the given port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-10">&nbsp;</div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-11"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">handlers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/(\w+)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">WordHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"example"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">handlers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">debug</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-18"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">WordHandler</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">RequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">words</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-21"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">set_status</span><span class="crayon-sy">(</span><span class="crayon-cn">404</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"error"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"word not found"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-28">&nbsp;</div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-29"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-e">parse_command_line</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">httpserver</span><span class="crayon-sy">.</span><span class="crayon-e">HTTPServer</span><span class="crayon-sy">(</span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2910e761011029-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-sy">.</span><span class="crayon-e">listen</span><span class="crayon-sy">(</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">port</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2910e761011029-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">ioloop</span><span class="crayon-sy">.</span><span class="crayon-v">IOLoop</span><span class="crayon-sy">.</span><span class="crayon-e">instance</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0138 seconds] -->
<p> </p>
<p>在命令行中像下面这样运行这个程序：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2911d675352097" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python definitions_readonly.py</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2911d675352097-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2911d675352097-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">definitions_readonly</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p> </p>
<p>现在使用curl或者你的浏览器来向应用发送一个请求。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29125973003863" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl http://localhost:8000/perturb
{"definition": "Bother, unsettle, modify", "word": "perturb"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29125973003863-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29125973003863-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29125973003863-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">curl </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">perturb</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29125973003863-2"><span class="crayon-sy">{</span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Bother, unsettle, modify"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"perturb"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p> </p>
<p>如果我们请求一个数据库中没有添加的单词，会得到一个404错误以及一个错误信息：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2912b321588344" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl http://localhost:8000/snorkle
{"error": "word not found"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2912b321588344-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2912b321588344-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2912b321588344-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">curl </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">snorkle</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2912b321588344-2"><span class="crayon-sy">{</span><span class="crayon-s">"error"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"word not found"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p> </p>
<p>那么这个程序是如何工作的呢？让我们看看这个程序的主线。开始，我们在程序的最上面导入了import pymongo库。然后我们在我们的TornadoApplication对象的__init__方法中实例化了一个pymongo连接对象。我们在Application对象中创建了一个db属性，指向MongoDB的example数据库。下面是相关的代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29132729288217" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">conn = pymongo.Connection("localhost", 27017)
self.db = conn["example"]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29132729288217-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29132729288217-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29132729288217-1"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29132729288217-2"><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"example"</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p> </p>
<p>一旦我们在Application对象中添加了db属性，我们就可以在任何RequestHandler对象中使用self.application.db访问它。实际上，这正是我们为了取出pymongo的words集合对象而在WordHandler中get方法所做的事情。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29138687083800" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def get(self, word):
    coll = self.application.db.words
    word_doc = coll.find_one({"word": word})
    if word_doc:
        del word_doc["_id"]
        self.write(word_doc)
    else:
        self.set_status(404)
        self.write({"error": "word not found"})</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29138687083800-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29138687083800-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b29138687083800-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29138687083800-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b29138687083800-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29138687083800-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b29138687083800-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29138687083800-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b29138687083800-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29138687083800-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29138687083800-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">words</span></div><div class="crayon-line" id="crayon-57ee2c4b29138687083800-3"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29138687083800-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29138687083800-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29138687083800-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29138687083800-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29138687083800-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">set_status</span><span class="crayon-sy">(</span><span class="crayon-cn">404</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29138687083800-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"error"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"word not found"</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p> </p>
<p>在我们将集合对象指定给变量coll后，我们使用用户在HTTP路径中请求的单词调用find_one方法。如果我们发现这个单词，则从字典中删除_id键（以便Python的json库可以将其序列化），然后将其传递给RequestHandler的write方法。write方法将会自动序列化字典为JSON格式。</p>
<p>如果find_one方法没有匹配任何对象，则返回None。在这种情况下，我们将响应状态设置为404，并且写一个简短的JSON来提示用户这个单词在数据库中没有找到。</p>
<h2>4.2.2 写字典</h2>
<p>从字典里查询单词很有趣，但是在交互解释器中添加单词的过程却很麻烦。我们例子的下一步是使HTTP请求网站服务时能够创建和修改单词。</p>
<p>它的工作流程是：发出一个特定单词的POST请求，将根据请求中给出的定义修改已经存在的定义。如果这个单词并不存在，则创建它。例如，创建一个新的单词：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2913f906952317" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl -d definition=a+leg+shirt http://localhost:8000/pants
{"definition": "a leg shirt", "word": "pants"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2913f906952317-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2913f906952317-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2913f906952317-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">definition</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-o">+</span><span class="crayon-v">leg</span><span class="crayon-o">+</span><span class="crayon-e">shirt </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">pants</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2913f906952317-2"><span class="crayon-sy">{</span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"a leg shirt"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"pants"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p> </p>
<p>我们可以使用一个GET请求来获得已创建单词的定义：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2914e929923072" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl http://localhost:8000/pants
{"definition": "a leg shirt", "word": "pants"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2914e929923072-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2914e929923072-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2914e929923072-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">curl </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">pants</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2914e929923072-2"><span class="crayon-sy">{</span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"a leg shirt"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"pants"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p> </p>
<p>我们可以发出一个带有一个单词定义域的POST请求来修改一个已经存在的单词（就和我们创建一个新单词时使用的参数一样）：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29156347501600" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ curl -d definition=a+boat+wizard http://localhost:8000/oarlock
{"definition": "a boat wizard", "word": "oarlock"}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29156347501600-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29156347501600-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29156347501600-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">definition</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-o">+</span><span class="crayon-v">boat</span><span class="crayon-o">+</span><span class="crayon-e">wizard </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">localhost</span><span class="crayon-o">:</span><span class="crayon-cn">8000</span><span class="crayon-o">/</span><span class="crayon-e">oarlock</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29156347501600-2"><span class="crayon-sy">{</span><span class="crayon-s">"definition"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"a boat wizard"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"oarlock"</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p> </p>
<p>代码清单4-2是我们的词典Web服务的读写版本的源代码。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2915c070979970" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">代码清单4-2 一个读写字典服务：definitions_readwrite.py</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web

import pymongo

from tornado.options import define, options
define("port", default=8000, help="run on the given port", type=int)

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [(r"/(\w+)", WordHandler)]
        conn = pymongo.Connection("localhost", 27017)
        self.db = conn["definitions"]
        tornado.web.Application.__init__(self, handlers, debug=True)

class WordHandler(tornado.web.RequestHandler):
    def get(self, word):
        coll = self.application.db.words
        word_doc = coll.find_one({"word": word})
        if word_doc:
            del word_doc["_id"]
            self.write(word_doc)
        else:
            self.set_status(404)
    def post(self, word):
        definition = self.get_argument("definition")
        coll = self.application.db.words
        word_doc = coll.find_one({"word": word})
        if word_doc:
            word_doc['definition'] = definition
            coll.save(word_doc)
        else:
            word_doc = {'word': word, 'definition': definition}
            coll.insert(word_doc)
        del word_doc["_id"]
        self.write(word_doc)

if __name__ == "__main__":
    tornado.options.parse_command_line()
    http_server = tornado.httpserver.HTTPServer(Application())
    http_server.listen(options.port)
    tornado.ioloop.IOLoop.instance().start()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-24">24</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-26">26</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-28">28</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-30">30</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-32">32</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-34">34</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-36">36</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-38">38</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-40">40</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-42">42</div><div class="crayon-num" data-line="crayon-57ee2c4b2915c070979970-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2915c070979970-44">44</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">httpserver</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">ioloop</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">web</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pymongo</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-8"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">define</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">options</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-9"><span class="crayon-e">define</span><span class="crayon-sy">(</span><span class="crayon-s">"port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">8000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"run on the given port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-10">&nbsp;</div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-11"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">handlers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/(\w+)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">WordHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"definitions"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">handlers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">debug</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-18"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">WordHandler</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">RequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">words</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-21"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">set_status</span><span class="crayon-sy">(</span><span class="crayon-cn">404</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">definition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">get_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"definition"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">words</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-30"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">'definition'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">definition</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-33"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'word'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'definition'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">definition</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-40"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-e">parse_command_line</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">httpserver</span><span class="crayon-sy">.</span><span class="crayon-e">HTTPServer</span><span class="crayon-sy">(</span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2915c070979970-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-sy">.</span><span class="crayon-e">listen</span><span class="crayon-sy">(</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">port</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2915c070979970-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">ioloop</span><span class="crayon-sy">.</span><span class="crayon-v">IOLoop</span><span class="crayon-sy">.</span><span class="crayon-e">instance</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0173 seconds] -->
<p> </p>
<p>除了在WordHandler中添加了一个post方法之外，这个源代码和只读服务的版本完全一样。让我们详细看看这个方法吧：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29164274984317" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def post(self, word):
    definition = self.get_argument("definition")
    coll = self.application.db.words
    word_doc = coll.find_one({"word": word})
    if word_doc:
        word_doc['definition'] = definition
        coll.save(word_doc)
    else:
        word_doc = {'word': word, 'definition': definition}
        coll.insert(word_doc)
    del word_doc["_id"]
    self.write(word_doc)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b29164274984317-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29164274984317-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29164274984317-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">definition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">get_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"definition"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29164274984317-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">words</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"word"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29164274984317-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">'definition'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">definition</span></div><div class="crayon-line" id="crayon-57ee2c4b29164274984317-7"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29164274984317-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">word_doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'word'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'definition'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">definition</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29164274984317-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">word_doc</span><span class="crayon-sy">[</span><span class="crayon-s">"_id"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29164274984317-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">word_doc</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0055 seconds] -->
<p> </p>
<p>我们首先做的事情是使用get_argument方法取得POST请求中传递的definition参数。然后，就像在get方法一样，我们尝试使用find_one方法从数据库中加载给定单词的文档。如果发现这个单词的文档，我们将definition条目的值设置为从POST参数中取得的值，然后调用集合对象的save方法将改变写到数据库中。如果没有发现文档，则创建一个新文档，并使用insert方法将其保存到数据库中。无论上述哪种情况，在数据库操作执行之后，我们在响应中写文档（注意首先要删掉_id属性）。</p>
<h1>4.3 Burt’s Books</h1>
<p>在第三章中，我们提出了Burt’s Book作为使用Tornado模板工具构建复杂Web应用的例子。在本节中，我们将展示使用MongoDB作为数据存储的Burt’s Books示例版本呢。</p>
<h2>4.3.1 读取书籍（从数据库）</h2>
<p>让我们从一些简单的版本开始：一个从数据库中读取书籍列表的Burt’s Books。首先，我们需要在我们的MongoDB服务器上创建一个数据库和一个集合，然后用书籍文档填充它，就像下面这样：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2916c921846420" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;&gt;&gt; import pymongo
&gt;&gt;&gt; conn = pymongo.Connection()
&gt;&gt;&gt; db = conn["bookstore"]
&gt;&gt;&gt; db.books.insert({
...     "title":"Programming Collective Intelligence",
...     "subtitle": "Building Smart Web 2.0 Applications",
...     "image":"/static/images/collective_intelligence.gif",
...     "author": "Toby Segaran",
...     "date_added":1310248056,
...     "date_released": "August 2007",
...     "isbn":"978-0-596-52932-1",
...     "description":"&lt;p&gt;[...]&lt;/p&gt;"
... })
ObjectId('4eb6f1a6136fc42171000000')
&gt;&gt;&gt; db.books.insert({
...     "title":"RESTful Web Services",
...     "subtitle": "Web services for the real world",
...     "image":"/static/images/restful_web_services.gif",
...     "author": "Leonard Richardson, Sam Ruby",
...     "date_added":1311148056,
...     "date_released": "May 2007",
...     "isbn":"978-0-596-52926-0",
...     "description":"&lt;p&gt;[...]&gt;/p&gt;"
... })
ObjectId('4eb6f1cb136fc42171000001')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2916c921846420-24">24</div><div class="crayon-num" data-line="crayon-57ee2c4b2916c921846420-25">25</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-1"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"bookstore"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">books</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-5"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-s">"Programming Collective Intelligence"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-6"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"subtitle"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Building Smart Web 2.0 Applications"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-7"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"image"</span><span class="crayon-o">:</span><span class="crayon-s">"/static/images/collective_intelligence.gif"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-8"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"author"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Toby Segaran"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-9"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"date_added"</span><span class="crayon-o">:</span><span class="crayon-cn">1310248056</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-10"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"date_released"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"August 2007"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-11"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-s">"978-0-596-52932-1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-12"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-s">"&lt;p&gt;[...]&lt;/p&gt;"</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-13"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-14"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb6f1a6136fc42171000000'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-15"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">books</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-16"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"title"</span><span class="crayon-o">:</span><span class="crayon-s">"RESTful Web Services"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-17"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"subtitle"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Web services for the real world"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-18"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"image"</span><span class="crayon-o">:</span><span class="crayon-s">"/static/images/restful_web_services.gif"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-19"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"author"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"Leonard Richardson, Sam Ruby"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-20"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"date_added"</span><span class="crayon-o">:</span><span class="crayon-cn">1311148056</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-21"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"date_released"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"May 2007"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-22"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-s">"978-0-596-52926-0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-23"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">"description"</span><span class="crayon-o">:</span><span class="crayon-s">"&lt;p&gt;[...]&gt;/p&gt;"</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2916c921846420-24"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2916c921846420-25"><span class="crayon-e">ObjectId</span><span class="crayon-sy">(</span><span class="crayon-s">'4eb6f1cb136fc42171000001'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0083 seconds] -->
<p> </p>
<p>（我们为了节省空间已经忽略了这些书籍的详细描述。）一旦我们在数据库中有了这些文档，我们就准备好了。代码清单4-3展示了Burt’s Books Web应用修改版本的源代码burts_books_db.py。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29177394073033" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">代码清单4-3 读取数据库：burts_books_db.py</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import os.path
import tornado.locale
import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web
from tornado.options import define, options
import pymongo

define("port", default=8000, help="run on the given port", type=int)

class Application(tornado.web.Application):
    def __init__(self):
        handlers = [
            (r"/", MainHandler),
            (r"/recommended/", RecommendedHandler),
        ]
        settings = dict(
            template_path=os.path.join(os.path.dirname(__file__), "templates"),
            static_path=os.path.join(os.path.dirname(__file__), "static"),
            ui_modules={"Book": BookModule},
            debug=True,
        )
        conn = pymongo.Connection("localhost", 27017)
        self.db = conn["bookstore"]
        tornado.web.Application.__init__(self, handlers, **settings)

class MainHandler(tornado.web.RequestHandler):
    def get(self):
        self.render(
            "index.html",
            page_title = "Burt's Books | Home",
            header_text = "Welcome to Burt's Books!",
        )

class RecommendedHandler(tornado.web.RequestHandler):
    def get(self):
        coll = self.application.db.books
        books = coll.find()
        self.render(
            "recommended.html",
            page_title = "Burt's Books | Recommended Reading",
            header_text = "Recommended Reading",
            books = books
        )

class BookModule(tornado.web.UIModule):
    def render(self, book):
        return self.render_string(
            "modules/book.html",
            book=book,
        )
    def css_files(self):
        return "/static/css/recommended.css"
    def javascript_files(self):
        return "/static/js/recommended.js"

if __name__ == "__main__":
    tornado.options.parse_command_line()
    http_server = tornado.httpserver.HTTPServer(Application())
    http_server.listen(options.port)
    tornado.ioloop.IOLoop.instance().start()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-24">24</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-26">26</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-28">28</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-30">30</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-32">32</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-34">34</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-36">36</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-38">38</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-40">40</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-42">42</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-44">44</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-46">46</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-48">48</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-50">50</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-52">52</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-54">54</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-56">56</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-58">58</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-60">60</div><div class="crayon-num" data-line="crayon-57ee2c4b29177394073033-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29177394073033-62">62</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29177394073033-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-k ">locale</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">httpserver</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">ioloop</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">web</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-7"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-e">options </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">define</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">options</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pymongo</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-10"><span class="crayon-e">define</span><span class="crayon-sy">(</span><span class="crayon-s">"port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">8000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"run on the given port"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">int</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-12"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">handlers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">MainHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/recommended/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">RecommendedHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">dict</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">template_path</span><span class="crayon-o">=</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-v">__file__</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"templates"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">static_path</span><span class="crayon-o">=</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-e">dirname</span><span class="crayon-sy">(</span><span class="crayon-v">__file__</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"static"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ui_modules</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">"Book"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">BookModule</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">debug</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"bookstore"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">Application</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">handlers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-v">settings</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-28"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">MainHandler</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">RequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"index.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page_title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Burt's Books | Home"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">header_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Welcome to Burt's Books!"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-36"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">RecommendedHandler</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">RequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-39"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">books</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"recommended.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page_title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Burt's Books | Recommended Reading"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">header_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Recommended Reading"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">books</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">books</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-46">&nbsp;</div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-47"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">BookModule</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">UIModule</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">book</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render_string</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"modules/book.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-o">=</span><span class="crayon-v">book</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">css_files</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"/static/css/recommended.css"</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">javascript_files</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"/static/js/recommended.js"</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-58"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">__name__</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"__main__"</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-e">parse_command_line</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">httpserver</span><span class="crayon-sy">.</span><span class="crayon-e">HTTPServer</span><span class="crayon-sy">(</span><span class="crayon-e">Application</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b29177394073033-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">http_server</span><span class="crayon-sy">.</span><span class="crayon-e">listen</span><span class="crayon-sy">(</span><span class="crayon-v">options</span><span class="crayon-sy">.</span><span class="crayon-v">port</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29177394073033-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">ioloop</span><span class="crayon-sy">.</span><span class="crayon-v">IOLoop</span><span class="crayon-sy">.</span><span class="crayon-e">instance</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0203 seconds] -->
<p> </p>
<p>正如你看到的，这个程序和第三章中Burt’s Books Web应用的原始版本几乎完全相同。它们之间只有两个不同点。其一，我们在我们的Application中添加了一个db属性来连接MongoDB服务器：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29180155823786" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">conn = pymongo.Connection("localhost", 27017)
self.db = conn["bookstore"]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29180155823786-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b29180155823786-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29180155823786-1"><span class="crayon-v">conn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pymongo</span><span class="crayon-sy">.</span><span class="crayon-e">Connection</span><span class="crayon-sy">(</span><span class="crayon-s">"localhost"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">27017</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b29180155823786-2"><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">conn</span><span class="crayon-sy">[</span><span class="crayon-s">"bookstore"</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p> </p>
<p>其二，我们使用连接的find方法来从数据库中取得书籍文档的列表，然后在渲染recommended.html时将这个列表传递给RecommendedHandler的get方法。下面是相关的代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2918f700501446" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def get(self):
    coll = self.application.db.books
    books = coll.find()
    self.render(
        "recommended.html",
        page_title = "Burt's Books | Recommended Reading",
        header_text = "Recommended Reading",
        books = books
    )</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2918f700501446-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2918f700501446-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b2918f700501446-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2918f700501446-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b2918f700501446-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2918f700501446-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b2918f700501446-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2918f700501446-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b2918f700501446-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2918f700501446-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2918f700501446-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line" id="crayon-57ee2c4b2918f700501446-3"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">books</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2918f700501446-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-57ee2c4b2918f700501446-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"recommended.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2918f700501446-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page_title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Burt's Books | Recommended Reading"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2918f700501446-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">header_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"Recommended Reading"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2918f700501446-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">books</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">books</span></div><div class="crayon-line" id="crayon-57ee2c4b2918f700501446-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0053 seconds] -->
<p> </p>
<p>此前，书籍列表是被硬编码在get方法中的。但是，因为我们在MongoDB中添加的文档和原始的硬编码字典拥有相同的域，所以我们之前写的模板代码并不需要修改。</p>
<p>像下面这样运行应用：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b29196126827156" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python burts_books_db.py</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b29196126827156-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b29196126827156-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">burts_books_db</span><span class="crayon-sy">.</span><span class="crayon-v">py</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p> </p>
<p>然后让你的浏览器指向http://localhost:8000/recommended/。这次，页面和硬编码版本的Burt’s Books看起来几乎一样（参见图3-6）。</p>
<h2>4.3.2 编辑和添加书籍</h2>
<p>我们的下一步是添加一个接口用来编辑已经存在于数据库的书籍以及添加新书籍到数据库中。为此，我们需要一个让用户填写书籍信息的表单，一个服务表单的处理程序，以及一个处理表单结果并将其存入数据库的处理函数。</p>
<p>这个版本的Burt’s Books和之前给出的代码几乎是一样的，只是增加了下面我们要讨论的一些内容。你可以跟随本书附带的完整代码阅读下面部分，相关的程序名为burts_books_rwdb.py。 </p>
<h3>4.3.2.1 渲染编辑表单</h3>
<p>下面是BookEditHandler的源代码，它完成了两件事情：</p>
<ol>
<li>GET请求渲染一个显示已存在书籍数据的HTML表单（在模板book_edit.html中）。</li>
<li>POST请求从表单中取得数据，更新数据库中已存在的书籍记录或依赖提供的数据添加一个新的书籍。</li>
</ol>
<p>下面是处理程序的源代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b2919d363552765" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">class BookEditHandler(tornado.web.RequestHandler):
    def get(self, isbn=None):
        book = dict()
        if isbn:
            coll = self.application.db.books
            book = coll.find_one({"isbn": isbn})
        self.render("book_edit.html",
            page_title="Burt's Books",
            header_text="Edit book",
            book=book)

    def post(self, isbn=None):
        import time
        book_fields = ['isbn', 'title', 'subtitle', 'image', 'author',
            'date_released', 'description']
        coll = self.application.db.books
        book = dict()
        if isbn:
            book = coll.find_one({"isbn": isbn})
        for key in book_fields:
            book[key] = self.get_argument(key, None)

        if isbn:
            coll.save(book)
        else:
            book['date_added'] = int(time.time())
            coll.insert(book)
        self.redirect("/recommended/")</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-24">24</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-26">26</div><div class="crayon-num" data-line="crayon-57ee2c4b2919d363552765-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b2919d363552765-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">BookEditHandler</span><span class="crayon-sy">(</span><span class="crayon-v">tornado</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">RequestHandler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-6"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-s">"book_edit.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page_title</span><span class="crayon-o">=</span><span class="crayon-s">"Burt's Books"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">header_text</span><span class="crayon-o">=</span><span class="crayon-s">"Edit book"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-o">=</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book_fields</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'isbn'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'title'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'subtitle'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'image'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'author'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'date_released'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'description'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-17"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">key </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">book_fields</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">get_argument</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-22">&nbsp;</div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-sy">[</span><span class="crayon-s">'date_added'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b2919d363552765-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b2919d363552765-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">redirect</span><span class="crayon-sy">(</span><span class="crayon-s">"/recommended/"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0159 seconds] -->
<p> </p>
<p>我们将在稍后对其进行详细讲解，不过现在先让我们看看如何在Application类中建立请求到处理程序的路由。下面是Application的__init__方法的相关代码部分：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291aa203515832" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">handlers = [
    (r"/", MainHandler),
    (r"/recommended/", RecommendedHandler),
    (r"/edit/([0-9Xx\-]+)", BookEditHandler),
    (r"/add", BookEditHandler)
]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291aa203515832-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291aa203515832-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b291aa203515832-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291aa203515832-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b291aa203515832-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291aa203515832-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291aa203515832-1"><span class="crayon-v">handlers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291aa203515832-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">MainHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b291aa203515832-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/recommended/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">RecommendedHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291aa203515832-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/edit/([0-9Xx\-]+)"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">BookEditHandler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b291aa203515832-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">"/add"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">BookEditHandler</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291aa203515832-6"><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p> </p>
<p>正如你所看到的，BookEditHandler处理了两个不同路径模式的请求。其中一个是/add，提供不存在信息的编辑表单，因此你可以向数据库中添加一本新的书籍；另一个/edit/([0-9Xx\-]+)，根据书籍的ISBN渲染一个已存在书籍的表单。</p>
<h3>4.3.2.2 从数据库中取出书籍信息</h3>
<p>让我们看看BookEditHandler的get方法是如何工作的：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291b2186429499" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def get(self, isbn=None):
    book = dict()
    if isbn:
        coll = self.application.db.books
        book = coll.find_one({"isbn": isbn})
    self.render("book_edit.html",
        page_title="Burt's Books",
        header_text="Edit book",
        book=book)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291b2186429499-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291b2186429499-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b291b2186429499-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291b2186429499-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b291b2186429499-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291b2186429499-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b291b2186429499-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291b2186429499-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b291b2186429499-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291b2186429499-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291b2186429499-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b291b2186429499-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291b2186429499-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line" id="crayon-57ee2c4b291b2186429499-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291b2186429499-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-s">"book_edit.html"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b291b2186429499-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">page_title</span><span class="crayon-o">=</span><span class="crayon-s">"Burt's Books"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291b2186429499-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">header_text</span><span class="crayon-o">=</span><span class="crayon-s">"Edit book"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-57ee2c4b291b2186429499-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-o">=</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p> </p>
<p>如果该方法作为到/add请求的结果被调用，Tornado将调用一个没有第二个参数的get方法（因为路径中没有正则表达式的匹配组）。在这种情况下，默认将一个空的book字典传递给book_edit.html模板。</p>
<p>如果该方法作为到类似于/edit/0-123-456请求的结果被调用，那么isdb参数被设置为0-123-456。在这种情况下，我们从Application实例中取得books集合，并用它查询ISBN匹配的书籍。然后我们传递结果book字典给模板。</p>
<p>下面是模板（book_edit.html）的代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291c1339271588" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">XHTML</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">{% extends "main.html" %}
{% autoescape None %}

{% block body %}
&lt;form method="POST"&gt;
    ISBN &lt;input type="text" name="isbn"
        value="{{ book.get('isbn', '') }}"&gt;&lt;br&gt;
    Title &lt;input type="text" name="title"
        value="{{ book.get('title', '') }}"&gt;&lt;br&gt;
    Subtitle &lt;input type="text" name="subtitle"
        value="{{ book.get('subtitle', '') }}"&gt;&lt;br&gt;
    Image &lt;input type="text" name="image"
        value="{{ book.get('image', '') }}"&gt;&lt;br&gt;
    Author &lt;input type="text" name="author"
        value="{{ book.get('author', '') }}"&gt;&lt;br&gt;
    Date released &lt;input type="text" name="date_released"
        value="{{ book.get('date_released', '') }}"&gt;&lt;br&gt;
    Description&lt;br&gt;
    &lt;textarea name="description" rows="5"
        cols="40"&gt;{% raw book.get('description', '')%}&lt;/textarea&gt;&lt;br&gt;
    &lt;input type="submit" value="Save"&gt;
&lt;/form&gt;
{% end %}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-18">18</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-20">20</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291c1339271588-22">22</div><div class="crayon-num" data-line="crayon-57ee2c4b291c1339271588-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-1"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>extends<span class="crayon-h"> </span><span class="crayon-s ">"main.html"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-2"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>autoescape<span class="crayon-h"> </span>None<span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-4"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>block<span class="crayon-h"> </span>body<span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-5"><span class="crayon-r ">&lt;form </span><span class="crayon-e ">method</span><span class="crayon-o">=</span><span class="crayon-s ">"POST"</span><span class="crayon-r ">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-6"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;ISBN </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"isbn"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('isbn', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-8"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Title </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"title"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('title', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-10"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Subtitle </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"subtitle"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('subtitle', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-12"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Image </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"image"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('image', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-14"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Author </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"author"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('author', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-16"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Date released </span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"text"</span><span class="crayon-h"> </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"date_released"</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book.get('date_released', '') }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-18"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;Description</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-19"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;textarea </span><span class="crayon-e ">name</span><span class="crayon-o">=</span><span class="crayon-s ">"description"</span><span class="crayon-h"> </span><span class="crayon-e ">rows</span><span class="crayon-o">=</span><span class="crayon-s ">"5"</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e ">cols</span><span class="crayon-o">=</span><span class="crayon-s ">"40"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">{% raw book.get('description', '')%}</span><span class="crayon-r ">&lt;/textarea&gt;</span><span class="crayon-r ">&lt;br&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-21"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;input </span><span class="crayon-e ">type</span><span class="crayon-o">=</span><span class="crayon-s ">"submit"</span><span class="crayon-h"> </span><span class="crayon-e ">value</span><span class="crayon-o">=</span><span class="crayon-s ">"Save"</span><span class="crayon-r ">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291c1339271588-22"><span class="crayon-r ">&lt;/form&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291c1339271588-23"><span class="crayon-sy">{</span><span class="crayon-o">%</span><span class="crayon-h"> </span>end<span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0113 seconds] -->
<p> </p>
<p>这是一个相当常规的HTML表单。如果请求处理函数传进来了book字典，那么我们用它预填充带有已存在书籍数据的表单；如果键不在字典中，我们使用Python字典对象的get方法为其提供默认值。记住input标签的name属性被设置为book字典的对应键；这使得与来自带有我们期望放入数据库数据的表单关联变得简单。</p>
<p>同样还需要记住的是，因为form标签没有action属性，因此表单的POST将会定向到当前URL，这正是我们想要的（即，如果页面以/edit/0-123-456加载，POST请求将转向/edit/0-123-456；如果页面以/add加载，则POST将转向/add）。图4-1所示为该页面渲染后的样子。</p>
<p><a href="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1.jpg"><img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/1x1.trans.gif" data-lazy-src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1.jpg" alt="Figure4-1" width="659" height="586" class="alignleft size-full wp-image-291" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1.jpg 659w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1-300x266.jpg 300w" sizes="(max-width: 659px) 100vw, 659px"><noscript>&lt;img src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1.jpg" alt="Figure4-1" width="659" height="586" class="alignleft size-full wp-image-291" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1.jpg 659w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-1-300x266.jpg 300w" sizes="(max-width: 659px) 100vw, 659px" /&gt;</noscript></a><br>
<em>图4-1 Burt’s Books：添加新书的表单</em></p>
<h3>4.3.2.3 保存到数据库中</h3>
<p>让我们看看BookEditHandler的post方法。这个方法处理书籍编辑表单的请求。下面是源代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291cb216710922" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">def post(self, isbn=None):
    import time
    book_fields = ['isbn', 'title', 'subtitle', 'image', 'author',
        'date_released', 'description']
    coll = self.application.db.books
    book = dict()
    if isbn:
        book = coll.find_one({"isbn": isbn})
    for key in book_fields:
        book[key] = self.get_argument(key, None)

    if isbn:
        coll.save(book)
    else:
        book['date_added'] = int(time.time())
        coll.insert(book)
    self.redirect("/recommended/")</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291cb216710922-16">16</div><div class="crayon-num" data-line="crayon-57ee2c4b291cb216710922-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">post</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book_fields</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'isbn'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'title'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'subtitle'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'image'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'author'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'date_released'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'description'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">application</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">books</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-6"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">find_one</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">"isbn"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">key </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">book_fields</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">get_argument</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">isbn</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">book</span><span class="crayon-sy">[</span><span class="crayon-s">'date_added'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-k ">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291cb216710922-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">coll</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">book</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-57ee2c4b291cb216710922-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">redirect</span><span class="crayon-sy">(</span><span class="crayon-s">"/recommended/"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0132 seconds] -->
<p> </p>
<p>和get方法一样，post方法也有两个任务：处理编辑已存在文档的请求以及添加新文档的请求。如果有isbn参数（即，路径的请求类似于/edit/0-123-456），我们假定为编辑给定ISBN的文档。如果这个参数没有被提供，则假定为添加一个新文档。</p>
<p>我们先设置一个空的字典变量book。如果我们正在编辑一个已存在的书籍，我们使用book集合的find_one方法从数据库中加载和传入的ISBN值对应的文档。无论哪种情况，book_fields列表指定哪些域应该出现在书籍文档中。我们迭代这个列表，使用RequestHandler对象的get_argument方法从POST请求中抓取对应的值。</p>
<p>此时，我们准备好更新数据库了。如果我们有一个ISBN码，那么我们调用集合的save方法来更新数据库中的书籍文档。如果没有的话，我们调用集合的insert方法，此时要注意首先要为date_added键添加一个值。（我们没有将其包含在我们的域列表中获取传入的请求，因为在图书被添加到数据库之后date_added值不应该再被改变。）当我们完成时，使用RequestHandler类的redirect方法给用户返回推荐页面。我们所做的任何改变可以立刻显现。图4-2所示为更新后的推荐页面。</p>
<p><a href="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2.jpg"><img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/1x1.trans.gif" data-lazy-src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2.jpg" alt="Figure4-2" width="662" height="888" class="alignleft size-full wp-image-292" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2.jpg 662w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2-223x300.jpg 223w" sizes="(max-width: 662px) 100vw, 662px"><noscript>&lt;img src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2.jpg" alt="Figure4-2" width="662" height="888" class="alignleft size-full wp-image-292" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2.jpg 662w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-2-223x300.jpg 223w" sizes="(max-width: 662px) 100vw, 662px" /&gt;</noscript></a><br>
<em>图4-2 Burt’s Books：带有新添加书籍的推荐列表</em></p>
<p>你还将注意到我们给每个图书条目添加了一个”Edit”链接，用于链接到列表中每个书籍的编辑表单。下面是修改后的图书模块的源代码：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291d3665687032" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">XHTML</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&lt;div class="book" style="overflow: auto"&gt;
    &lt;h3 class="book_title"&gt;{{ book["title"] }}&lt;/h3&gt;
    {% if book["subtitle"] != "" %}
        &lt;h4 class="book_subtitle"&gt;{{ book["subtitle"] }}&lt;/h4&gt;
    {% end %}
    &lt;img src="{{ book["image"] }}" class="book_image"/&gt;
    &lt;div class="book_details"&gt;
        &lt;div class="book_date_released"&gt;Released: {{ book["date_released"]}}&lt;/div&gt;
        &lt;div class="book_date_added"&gt;Added: {{ locale.format_date(book["date_added"],
relative=False) }}&lt;/div&gt;
        &lt;h5&gt;Description:&lt;/h5&gt;
        &lt;div class="book_body"&gt;{% raw book["description"] %}&lt;/div&gt;
        &lt;p&gt;&lt;a href="/edit/{{ book['isbn'] }}"&gt;Edit&lt;/a&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-2">2</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-4">4</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-6">6</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-8">8</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-10">10</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-12">12</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-57ee2c4b291d3665687032-14">14</div><div class="crayon-num" data-line="crayon-57ee2c4b291d3665687032-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-1"><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book"</span><span class="crayon-h"> </span><span class="crayon-e ">style</span><span class="crayon-o">=</span><span class="crayon-s ">"overflow: auto"</span><span class="crayon-r ">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-2"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;h3 </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_title"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">{{ book["title"] }}</span><span class="crayon-r ">&lt;/h3&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-3"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;{% if book["subtitle"] != "" %}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-4"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;h4 </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_subtitle"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">{{ book["subtitle"] }}</span><span class="crayon-r ">&lt;/h4&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-5"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;{% end %}</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-6"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;img </span><span class="crayon-e ">src</span><span class="crayon-o">=</span><span class="crayon-s ">"{{ book["</span>image<span class="crayon-s ">"] }}"</span><span class="crayon-h"> </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_image"</span><span class="crayon-r ">/&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-7"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_details"</span><span class="crayon-r ">&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-8"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_date_released"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Released: {{ book["date_released"]}}</span><span class="crayon-r ">&lt;/div&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-9"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_date_added"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Added: {{ locale.format_date(book["date_added"],</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-10"><span class="crayon-i ">relative=False) }}</span><span class="crayon-r ">&lt;/div&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-11"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;h5&gt;</span><span class="crayon-i ">Description:</span><span class="crayon-r ">&lt;/h5&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-12"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;div </span><span class="crayon-e ">class</span><span class="crayon-o">=</span><span class="crayon-s ">"book_body"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">{% raw book["description"] %}</span><span class="crayon-r ">&lt;/div&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-13"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;a </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"/edit/{{ book['isbn'] }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Edit</span><span class="crayon-r ">&lt;/a&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-57ee2c4b291d3665687032-14"><span class="crayon-i ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r ">&lt;/div&gt;</span></div><div class="crayon-line" id="crayon-57ee2c4b291d3665687032-15"><span class="crayon-r ">&lt;/div&gt;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p> </p>
<p>其中最重要的一行是：</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-57ee2c4b291e3920896200" class="crayon-syntax crayon-theme-son-of-obsidian crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">XHTML</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&lt;p&gt;&lt;a href="/edit/{{ book['isbn'] }}"&gt;Edit&lt;/a&gt;&lt;/p&gt;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-57ee2c4b291e3920896200-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-57ee2c4b291e3920896200-1"><span class="crayon-r ">&lt;p&gt;</span><span class="crayon-r ">&lt;a </span><span class="crayon-e ">href</span><span class="crayon-o">=</span><span class="crayon-s ">"/edit/{{ book['isbn'] }}"</span><span class="crayon-r ">&gt;</span><span class="crayon-i ">Edit</span><span class="crayon-r ">&lt;/a&gt;</span><span class="crayon-r ">&lt;/p&gt;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p> </p>
<p>编辑页面的链接是把图书的isbn键的值添加到字符串/edit/后面组成的。这个链接将会带你进入这本图书的编辑表单。你可以从图4-3中看到结果。</p>
<p><a href="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3.jpg"><img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/1x1.trans.gif" data-lazy-src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3.jpg" alt="Figure4-3" width="678" height="855" class="alignleft size-full wp-image-293" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3.jpg 678w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3-237x300.jpg 237w" sizes="(max-width: 678px) 100vw, 678px"><noscript>&lt;img src="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3.jpg" alt="Figure4-3" width="678" height="855" class="alignleft size-full wp-image-293" srcset="http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3.jpg 678w, http://www.pythoner.com/wp-content/uploads/2013/08/Figure4-3-237x300.jpg 237w" sizes="(max-width: 678px) 100vw, 678px" /&gt;</noscript></a><br>
<em>图4-3 Burt’s Books：带有编辑链接的推荐列表</em></p>
<h1>4.4 MongoDB：下一步</h1>
<p>我们在这里只覆盖了MongoDB的一些基础知识–仅仅够实现本章中的示例Web应用。如果你对于学习更多更用的PyMongo和MongoDB知识感兴趣的话，PyMongo教程（<a href="http://api.mongodb.org/python/2.0.1/tutorial.html" target="_blank">http://api.mongodb.org/python/2.0.1/tutorial.html</a>）和MongoDB教程（<a href="http://www.mongodb.org/display/DOCS/Tutorial" target="_blank">http://www.mongodb.org/display/DOCS/Tutorial</a>）是不错的起点。</p>
<p>如果你对使用Tornado创建在扩展性方面表现更好的MongoDB应用感兴趣的话，你可以自学asyncmongo（<a href="https://github.com/bitly/asyncmongo" target="_blank">https://github.com/bitly/asyncmongo</a>），这是一种异步执行MongoDB请求的类似PyMongo的库。我们将在第5章中讨论什么是异步请求，以及为什么它在Web应用中扩展性更好。</p>
<p>========================================================<br>
<strong>各章链接：</strong><br>
<a href="http://www.pythoner.com/273.html" title="《Introduction to Tornado》中文翻译计划——第一章：引言" target="_blank">《Introduction to Tornado》中文翻译计划——第一章：引言</a><br>
<a href="http://www.pythoner.com/274.html" title="《Introduction to Tornado》中文翻译计划——第二章：表单和模板" target="_blank">《Introduction to Tornado》中文翻译计划——第二章：表单和模板</a><br>
<a href="http://www.pythoner.com/282.html" title="《Introduction to Tornado》中文翻译计划——第三章：模板扩展" target="_blank">《Introduction to Tornado》中文翻译计划——第三章：模板扩展</a><br>
<a href="http://www.pythoner.com/283.html" title="《Introduction to Tornado》中文翻译计划——第四章：数据库" target="_blank">《Introduction to Tornado》中文翻译计划——第四章：数据库</a><br>
<a href="http://www.pythoner.com/294.html" title="《Introduction to Tornado》中文翻译计划——第五章：异步Web服务" target="_blank">《Introduction to Tornado》中文翻译计划——第五章：异步Web服务</a><br>
<a href="http://www.pythoner.com/295.html" title="《Introduction to Tornado》中文翻译计划——第六章：编写安全应用" target="_blank">《Introduction to Tornado》中文翻译计划——第六章：编写安全应用</a><br>
<a href="http://www.pythoner.com/302.html" title="《Introduction to Tornado》中文翻译计划——第七章：外部服务认证" target="_blank">《Introduction to Tornado》中文翻译计划——第七章：外部服务认证</a><br>
<a href="http://www.pythoner.com/303.html" title="《Introduction to Tornado》中文翻译计划——第八章：部署Tornado" target="_blank">《Introduction to Tornado》中文翻译计划——第八章：部署Tornado</a>
</p><div class="post_copyright">
<p>本文内容遵从<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">CC3.0版权协议</a>，转载请注明：转自<a href="http://www.pythoner.com/">Pythoner</a></p>
<p>本文链接地址：<a href="http://www.pythoner.com/283.html">《Introduction to Tornado》中文翻译计划——第四章：数据库</a></p>
</div>

<div class="wp_rp_wrap  wp_rp_plain" id="wp_rp_first"><div class="wp_rp_content"><h3 class="related_post_title">相关文章</h3><ul class="related_post wp_rp"><li data-position="0" data-poid="in-294" data-post-type="none"><a href="http://www.pythoner.com/294.html" class="wp_rp_title">《Introduction to Tornado》中文翻译计划——第五章：异步Web服务</a></li><li data-position="1" data-poid="in-295" data-post-type="none"><a href="http://www.pythoner.com/295.html" class="wp_rp_title">《Introduction to Tornado》中文翻译计划——第六章：编写安全应用</a></li><li data-position="2" data-poid="in-303" data-post-type="none"><a href="http://www.pythoner.com/303.html" class="wp_rp_title">《Introduction to Tornado》中文翻译计划——第八章：部署Tornado</a></li><li data-position="3" data-poid="in-302" data-post-type="none"><a href="http://www.pythoner.com/302.html" class="wp_rp_title">《Introduction to Tornado》中文翻译计划——第七章：外部服务认证</a></li><li data-position="4" data-poid="in-282" data-post-type="none"><a href="http://www.pythoner.com/282.html" class="wp_rp_title">《Introduction to Tornado》中文翻译计划——第三章：模板扩展</a></li></ul><div class="wp_rp_footer"><a class="wp_rp_backlink" target="_blank" href="http://www.zemanta.com/?wp-related-posts" rel="nofollow">Zemanta</a></div></div></div>
            <div class="post_baidushare_down clearfix">
       <!-- Baidu Button BEGIN -->
       <div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare">
       <a class="bds_tsina" title="分享到新浪微博" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_renren" title="分享到人人网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_tqq" title="分享到腾讯微博" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_qzone" title="分享到QQ空间" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_douban" title="分享到豆瓣网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_diandian" title="分享到点点网" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_twi" title="分享到Twitter" href="http://www.pythoner.com/283.html#"></a>
       <a class="bds_fbook" title="分享到Facebook" href="http://www.pythoner.com/283.html#"></a>
       <span class="bds_more"></span>
       <a class="shareCount" href="http://www.pythoner.com/283.html#" title="累计分享1次">1</a>
       </div>
       <script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1482744"></script>
       
       <script type="text/javascript">
       document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
       </script>
       <!-- Baidu Button END -->
       </div>
     </div><!-- END .post_content -->
    </div>
    <div class="meta">
          <ul>
            <li class="post_date clearfix">
       <span class="date">02</span>
       <span class="month">Aug</span>
       <span class="year">2013</span>
      </li>
            <li class="post_author"><a href="http://www.pythoner.com/author/alioth310" title="由alioth310发布" rel="author">alioth310</a></li>      <li class="post_category"><a href="http://www.pythoner.com/category/programming-language/python/tornado" rel="category tag">Tornado</a></li>      <li class="post_tag"><a href="http://www.pythoner.com/tag/github" rel="tag">GitHub</a>, <a href="http://www.pythoner.com/tag/python" rel="tag">python</a>, <a href="http://www.pythoner.com/tag/tornado" rel="tag">Tornado</a>, <a href="http://www.pythoner.com/tag/%e7%bf%bb%e8%af%91" rel="tag">翻译</a></li>      <li class="post_views"> 2,784 次围观</li>      <li class="post_comment"><a href="http://www.pythoner.com/283.html#comments">只有一条评论</a></li>            <li class="post_qrcode"><img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/chart" title="获取本文二维码：《Introduction to Tornado》中文翻译计划——第四章：数据库"></li>
     </ul>
         </div>
   </div><!-- END .post_wrap -->

   
      <div id="comments_wrapper">
    



<div id="comment_header" class="clearfix">

 <ul id="comment_header_left">
  <li id="add_comment"><a href="http://www.pythoner.com/283.html#respond">发表评论</a></li>
  <li id="comment_feed"><a href="http://www.pythoner.com/comments/feed" title="RSS订阅评论">RSS订阅评论</a></li>
 </ul>

 <ul id="comment_header_right">
   <li id="trackback_switch"><a href="javascript:void(0);">Trackback ( 0 )</a></li>
   <li id="comment_switch" class="comment_switch_active"><a href="javascript:void(0);">评论 ( 1 )</a></li>
 </ul>



</div><!-- END #comment_header -->

<div id="comments">

 <div id="comment_area">
  <!-- start commnet -->
  <ol class="commentlist">
	
 <li class="comment guest-comment even_comment" id="comment-2061">
  <div class="comment-meta">
   <div class="comment-meta-left">
  <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/1x1.trans.gif" data-lazy-src="http://2.gravatar.com/avatar/88f938856f01a76f373d6dc87ff05fbf?s=35&amp;d=mm&amp;r=g" alt="" srcset="http://2.gravatar.com/avatar/88f938856f01a76f373d6dc87ff05fbf?s=70&amp;d=mm&amp;r=g 2x" class="avatar avatar-35 photo" height="35" width="35"><noscript>&lt;img alt='' src='http://2.gravatar.com/avatar/88f938856f01a76f373d6dc87ff05fbf?s=35&amp;#038;d=mm&amp;#038;r=g' srcset='http://2.gravatar.com/avatar/88f938856f01a76f373d6dc87ff05fbf?s=70&amp;amp;d=mm&amp;amp;r=g 2x' class='avatar avatar-35 photo' height='35' width='35' /&gt;</noscript>  
    <ul class="comment-name-date">
     <li class="comment-name">
<span id="commentauthor-2061">

hartnett
</span>
     </li>
     <li class="comment-date">2013/08/02 10:05上午</li>
    </ul>
   </div>

   <ul class="comment-act">
    <li class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://www.pythoner.com/283.html?replytocom=2061#respond" onclick="return addComment.moveForm( &quot;comment-content-2061&quot;, &quot;2061&quot;, &quot;respond&quot;, &quot;283&quot; )" aria-label="回复给hartnett"><span><span>回复</span></span></a></li>
    <li class="comment-quote"><a href="javascript:void(0);" onclick="MGJS_CMT.quote(&#39;commentauthor-2061&#39;, &#39;comment-2061&#39;, &#39;comment-content-2061&#39;, &#39;comment&#39;);">引用</a></li>
       </ul>

  </div>
  <div class="comment-content" id="comment-content-2061">
    <p>辛苦楼主，已经在github中star <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/daxiao.gif" alt="[em_daxiao]" class="wp-smiley" style="height: 1em; max-height: 1em;"></p>
  </div>

</li><!-- #comment-## -->
  </ol>
  <!-- comments END -->

  
 </div><!-- #comment-list END -->


 <div id="trackback_area">
 <!-- start trackback -->
 
  <div id="trackback_url_wrapper">
   <label for="trackback_url">TrackBack 地址</label>
   <input type="text" name="trackback_url" id="trackback_url" size="60" value="http://www.pythoner.com/283.html/trackback" readonly="readonly" onfocus="this.select()">
  </div>

  <ol class="commentlist">
      <li class="comment"><div class="comment-content"><p>暂无 Trackback</p></div></li>
     </ol>

  <!-- trackback end -->
 </div><!-- #trackbacklist END -->

 


 
 <fieldset class="comment_form_wrapper" id="respond">

    <div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.pythoner.com/283.html#respond" style="display:none;">点击这里取消回复。</a></div>
  
  <form action="http://www.pythoner.com/wp-comments-post.php" method="post" id="commentform">

   
   <div id="guest_info">
    <div id="guest_name"><label for="author"><span>昵称</span>( 必须 )</label><input type="text" name="author" id="author" value="" size="22" tabindex="1" aria-required="true"></div>
    <div id="guest_email"><label for="email"><span>E-MAIL</span>( 必须 ) - 不会公开 -</label><input type="text" name="email" id="email" value="" size="22" tabindex="2" aria-required="true"></div>
    <div id="guest_url"><label for="url"><span>网址</span></label><input type="text" name="url" id="url" value="" size="22" tabindex="3"></div>
   </div>

   
   <div id="comment_textarea">
    <textarea name="comment" id="comment" cols="50" rows="10" tabindex="4" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById(&#39;submit_comment&#39;).click();return false};"></textarea>
   </div>

  <div id="custom_smilies">
	<!-- Custom Smilies - Version 2.9.2 -->
	<style type="text/css">
	img.wp-smiley-select {cursor: pointer;}
	</style>
    <script type="text/javascript">
    function grin(tag) {
    	if (typeof tinyMCE != 'undefined') {
    		grin_tinymcecomments(tag);
    	} else {
    		grin_plain(tag);
    	}
    }
    function grin_tinymcecomments(tag) {
    	tinyMCE.execCommand('mceInsertContent', false, ' ' + tag + ' ');
    }
    
    function grin_plain(tag) {
    	var myField;
    	var myCommentTextarea = "comment";
    	tag = ' ' + tag + ' ';
        if (document.getElementById(myCommentTextarea) && document.getElementById(myCommentTextarea).type == 'textarea') {
    		myField = document.getElementById(myCommentTextarea);
    	} else {
    		return false;
    	}
    	if (document.selection) {
    		myField.focus();
    		sel = document.selection.createRange();
    		sel.text = tag;
    		myField.focus();
    	}
    	else if (myField.selectionStart || myField.selectionStart == '0') {
    		var startPos = myField.selectionStart;
    		var endPos = myField.selectionEnd;
    		var cursorPos = endPos;
    		myField.value = myField.value.substring(0, startPos)
    					  + tag
    					  + myField.value.substring(endPos, myField.value.length);
    		cursorPos += tag.length;
    		myField.focus();
    		myField.selectionStart = cursorPos;
    		myField.selectionEnd = cursorPos;
    	}
    	else {
    		myField.value += tag;
    		myField.focus();
    	}
    }
    
    function moreSmilies() {
    	document.getElementById('wp-smiley-more').style.display = 'inline';
    	document.getElementById('wp-smiley-toggle').innerHTML = '<a href="javascript:lessSmilies()">&laquo;&nbsp;less</a></span>';
    }
    
    function lessSmilies() {
    	document.getElementById('wp-smiley-more').style.display = 'none';
    	document.getElementById('wp-smiley-toggle').innerHTML = '<a href="javascript:moreSmilies()">more&nbsp;&raquo;</a>';
    }
    </script>
<img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/good.gif" alt="[em_zan]" onclick="grin(&quot;[em_zan]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/yali.gif" alt="[em_yali]" onclick="grin(&quot;[em_yali]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/xiao.gif" alt="[em_xiao]" onclick="grin(&quot;[em_xiao]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/xhj.gif" alt="[em_xhj]" onclick="grin(&quot;[em_xhj]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/tucao.gif" alt="[em_tucao]" onclick="grin(&quot;[em_tucao]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/tu.gif" alt="[em_tu]" onclick="grin(&quot;[em_tu]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/tiaopi.gif" alt="[em_tiaopi]" onclick="grin(&quot;[em_tiaopi]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/shaoxiang.gif" alt="[em_sx]" onclick="grin(&quot;[em_sx]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/shudaizi.gif" alt="[em_sdz]" onclick="grin(&quot;[em_sdz]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/shangbuqi.gif" alt="[em_sbq]" onclick="grin(&quot;[em_sbq]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/mobai.gif" alt="[em_mobai]" onclick="grin(&quot;[em_mobai]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/kouzhao.gif" alt="[em_kzh]" onclick="grin(&quot;[em_kzh]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/ku.gif" alt="[em_ku]" onclick="grin(&quot;[em_ku]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/koushui.gif" alt="[em_ksh]" onclick="grin(&quot;[em_ksh]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/keai.gif" alt="[em_keai]" onclick="grin(&quot;[em_keai]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jiong.gif" alt="[em_jiong]" onclick="grin(&quot;[em_jiong]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jing.gif" alt="[em_jing]" onclick="grin(&quot;[em_jing]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/huaixiao.gif" alt="[em_hx]" onclick="grin(&quot;[em_hx]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/han.gif" alt="[em_han]" onclick="grin(&quot;[em_han]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/ganga.gif" alt="[em_ganga]" onclick="grin(&quot;[em_ganga]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/daxiao.gif" alt="[em_daxiao]" onclick="grin(&quot;[em_daxiao]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/cool.gif" alt="[em_cool]" onclick="grin(&quot;[em_cool]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/chi.gif" alt="[em_chi]" onclick="grin(&quot;[em_chi]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/bu.gif" alt="[em_bu]" onclick="grin(&quot;[em_bu]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/bizui.gif" alt="[em_bizui]" onclick="grin(&quot;[em_bizui]&quot;)" class="wp-smiley-select"> <img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/ai.gif" alt="[em_ai]" onclick="grin(&quot;[em_ai]&quot;)" class="wp-smiley-select"> </div>

   <div id="submit_comment_wrapper">
    <p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3d70f72e6f"></p><p style="display: none;"></p>    <input name="submit" type="submit" id="submit_comment" tabindex="5" value="发表评论/Ctrl+Enter" title="发表评论/Ctrl+Enter" alt="发表评论/Ctrl+Enter">
   </div>
   <div id="input_hidden_field">
        <input type="hidden" name="comment_post_ID" value="283" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
       </div>

  <input type="hidden" id="ak_js" name="ak_js" value="1475227498869"></form>

 </fieldset><!-- #comment-form-area END -->

</div><!-- #comment end -->   </div>
   
      <div id="previous_next_post_single">
    <div class="clearfix">
     <p id="previous_post"><a href="http://www.pythoner.com/282.html" rel="prev">《Introduction to Tornado》中文翻译计划——第三章：模板扩展</a></p>     <p id="next_post"><a href="http://www.pythoner.com/294.html" rel="next">《Introduction to Tornado》中文翻译计划——第五章：异步Web服务</a></p>    </div>
   </div>
   

  </div><!-- END #left_col -->

  <div id="container" style="height: 19176px;"></div>

    <div id="right_col">
   
<div id="info_area">
 <div class="side_box clearfix" id="info_content">
    <h3 class="side_title">扫描二维码访问本站</h3>
    <div class="desc">
   <p><img src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/pythoner_qrcode_150.png" alt="扫描二维码访问本站"></p>
  </div>
 </div>
</div>

<div class="side_box clearfix" id="side_meta_content">

  <ul id="social_link" class="clearfix">
    <li class="rss_button"><a class="target_blank" href="http://www.pythoner.com/feed" target="_blank">rss</a></li>
          <li class="weibo_button"><a class="target_blank" href="http://weibo.com/alioth310" target="_blank">weibo</a></li>
         </ul>
 
  <div id="search_area">
    <form method="get" id="searchform" action="http://www.pythoner.com/">
   <div><input id="search_button" class="rollover" type="image" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/search_button.gif" alt="搜索一下" title="搜索一下"></div>
   <div><input id="search_input" type="text" value="搜索一下" name="s" onfocus="if (this.value == &#39;搜索一下&#39;) this.value = &#39;&#39;;" onblur="if (this.value == &#39;&#39;) this.value = &#39;搜索一下&#39;;"></div>
  </form>
   </div>
 
</div>


<div id="side_top">

 <div class="side_box widget_text" id="text-3">
<h3 class="side_title">支持我</h3>
			<div class="textwidget"><ul>
  <li><a href="https://www.digitalocean.com/?refcode=32ac9c46cd67">DigitalOcean邀请注册（送10刀）</a></li>
  <li>域名出售：
    <ul>
      <li>shangpolu.com（上坡路）</li>
      <li>pythonsky.com</li>
    </ul>
  </li> 
</ul></div>
		</div>
<div class="side_box widget_views" id="views-2">
<h3 class="side_title">热门文章</h3>
<ul>
<li><a href="http://www.pythoner.com/83.html" title="Windows下PyQt4的安装">Windows下PyQt4的安装</a></li><li><a href="http://www.pythoner.com/106.html" title="Windows下Eclipse+PyDev安装Python开发环境">Windows下Eclipse+PyDev安装Python开发环境</a></li><li><a href="http://www.pythoner.com/46.html" title="Python函数式编程——map()、reduce()">Python函数式编程——map()、reduce()</a></li><li><a href="http://www.pythoner.com/89.html" title="使用eric创建一个PyQt项目">使用eric创建一个PyQt项目</a></li><li><a href="http://www.pythoner.com/205.html" title="Python标准库——collections模块的Counter类">Python标准库——collections模块的Counter类</a></li><li><a href="http://www.pythoner.com/111.html" title="使用Py2exe将PyQt程序打包为exe文件">使用Py2exe将PyQt程序打包为exe文件</a></li><li><a href="http://www.pythoner.com/13.html" title="Python中如何实现两个字典合并">Python中如何实现两个字典合并</a></li><li><a href="http://www.pythoner.com/273.html" title="《Introduction to Tornado》中文翻译计划——第一章：引言">《Introduction to Tornado》中文翻译计划——第一章：引言</a></li><li><a href="http://www.pythoner.com/148.html" title="【Python教程】雨痕 的《Python学习笔记》（附脑图）">【Python教程】雨痕 的《Python学习笔记》（附脑图）</a></li><li><a href="http://www.pythoner.com/238.html" title="《机器学习实战》读书笔记">《机器学习实战》读书笔记</a></li></ul>
</div>
		<div class="side_box widget_recent_entries" id="recent-posts-2">
		<h3 class="side_title">最新文章</h3>
		<ul>
					<li>
				<a href="http://www.pythoner.com/474.html">《Python核心编程（第3版）》勘误</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/416.html">【漏洞预警】Tornado某缺陷可能造成文件读取漏洞 （updated @ 2015-03-04）</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/414.html">使用Python下载邮件（pop/imap）</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/386.html">《Web之困》读书笔记</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/364.html">Tornado 4.0发布</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/357.html">Python设置终端显示颜色、粗体、下划线等效果</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/356.html">Python天坑系列（一）：while 1比while True更快？</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/345.html">Python socket模拟TCP通讯</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/337.html">《思考的乐趣》读书笔记</a>
						</li>
					<li>
				<a href="http://www.pythoner.com/329.html">《代码的未来》读书笔记</a>
						</li>
				</ul>
		</div>
		<div class="side_box widget_recent_comments" id="recent-comments-2">
<h3 class="side_title">最新评论</h3>
<ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Nicoder</span>发表在《<a href="http://www.pythoner.com/205.html#comment-43572">Python标准库——collections模块的Counter类</a>》</li><li class="recentcomments"><span class="comment-author-link">analgestic</span>发表在《<a href="http://www.pythoner.com/89.html#comment-43471">使用eric创建一个PyQt项目</a>》</li><li class="recentcomments"><span class="comment-author-link">dmdoge</span>发表在《<a href="http://www.pythoner.com/46.html#comment-43467">Python函数式编程——map()、reduce()</a>》</li><li class="recentcomments"><span class="comment-author-link">alioth310</span>发表在《<a href="http://www.pythoner.com/196.html#comment-43430">配置SecureCRT连接本地虚拟机中的Linux系统</a>》</li><li class="recentcomments"><span class="comment-author-link">cheryH</span>发表在《<a href="http://www.pythoner.com/196.html#comment-43427">配置SecureCRT连接本地虚拟机中的Linux系统</a>》</li></ul></div>
<div class="side_box widget_tag_cloud" id="tag_cloud-2">
<h3 class="side_title">标签云</h3>
<div class="tagcloud"><a href="http://www.pythoner.com/tag/dict" class="tag-link-6 tag-link-position-1" title="2个话题" style="font-size: 9.8pt;">dict</a>
<a href="http://www.pythoner.com/tag/discuz" class="tag-link-49 tag-link-position-2" title="2个话题" style="font-size: 9.8pt;">discuz</a>
<a href="http://www.pythoner.com/tag/editplus" class="tag-link-73 tag-link-position-3" title="2个话题" style="font-size: 9.8pt;">EditPlus</a>
<a href="http://www.pythoner.com/tag/eric" class="tag-link-59 tag-link-position-4" title="2个话题" style="font-size: 9.8pt;">eric</a>
<a href="http://www.pythoner.com/tag/git" class="tag-link-53 tag-link-position-5" title="2个话题" style="font-size: 9.8pt;">git</a>
<a href="http://www.pythoner.com/tag/github" class="tag-link-105 tag-link-position-6" title="9个话题" style="font-size: 15pt;">GitHub</a>
<a href="http://www.pythoner.com/tag/ide" class="tag-link-60 tag-link-position-7" title="2个话题" style="font-size: 9.8pt;">ide</a>
<a href="http://www.pythoner.com/tag/linux" class="tag-link-142 tag-link-position-8" title="4个话题" style="font-size: 12pt;">Linux</a>
<a href="http://www.pythoner.com/tag/matplotlib" class="tag-link-87 tag-link-position-9" title="2个话题" style="font-size: 9.8pt;">matplotlib</a>
<a href="http://www.pythoner.com/tag/mongodb" class="tag-link-147 tag-link-position-10" title="2个话题" style="font-size: 9.8pt;">MongoDB</a>
<a href="http://www.pythoner.com/tag/mysql" class="tag-link-144 tag-link-position-11" title="3个话题" style="font-size: 11pt;">MySQL</a>
<a href="http://www.pythoner.com/tag/nosql" class="tag-link-32 tag-link-position-12" title="2个话题" style="font-size: 9.8pt;">NoSQL</a>
<a href="http://www.pythoner.com/tag/php" class="tag-link-14 tag-link-position-13" title="2个话题" style="font-size: 9.8pt;">php</a>
<a href="http://www.pythoner.com/tag/pyqt" class="tag-link-57 tag-link-position-14" title="5个话题" style="font-size: 12.8pt;">PyQt</a>
<a href="http://www.pythoner.com/tag/python" class="tag-link-138 tag-link-position-15" title="49个话题" style="font-size: 22pt;">python</a>
<a href="http://www.pythoner.com/tag/pythonic" class="tag-link-5 tag-link-position-16" title="1个话题" style="font-size: 8pt;">pythonic</a>
<a href="http://www.pythoner.com/tag/shell" class="tag-link-65 tag-link-position-17" title="4个话题" style="font-size: 12pt;">Shell</a>
<a href="http://www.pythoner.com/tag/tornado" class="tag-link-146 tag-link-position-18" title="12个话题" style="font-size: 16.1pt;">Tornado</a>
<a href="http://www.pythoner.com/tag/ubuntu" class="tag-link-83 tag-link-position-19" title="3个话题" style="font-size: 11pt;">Ubuntu</a>
<a href="http://www.pythoner.com/tag/web" class="tag-link-104 tag-link-position-20" title="2个话题" style="font-size: 9.8pt;">Web</a>
<a href="http://www.pythoner.com/tag/wordpress" class="tag-link-139 tag-link-position-21" title="4个话题" style="font-size: 12pt;">WordPress</a>
<a href="http://www.pythoner.com/tag/%e4%b8%ad%e6%96%87%e4%b9%b1%e7%a0%81" class="tag-link-88 tag-link-position-22" title="2个话题" style="font-size: 9.8pt;">中文乱码</a>
<a href="http://www.pythoner.com/tag/%e4%ba%ba%e4%ba%ba%e7%bd%91" class="tag-link-42 tag-link-position-23" title="2个话题" style="font-size: 9.8pt;">人人网</a>
<a href="http://www.pythoner.com/tag/%e4%bb%a3%e7%a0%81" class="tag-link-43 tag-link-position-24" title="6个话题" style="font-size: 13.5pt;">代码</a>
<a href="http://www.pythoner.com/tag/%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b" class="tag-link-22 tag-link-position-25" title="4个话题" style="font-size: 12pt;">函数式编程</a>
<a href="http://www.pythoner.com/tag/%e5%88%97%e8%a1%a8%e8%a7%a3%e6%9e%90" class="tag-link-27 tag-link-position-26" title="2个话题" style="font-size: 9.8pt;">列表解析</a>
<a href="http://www.pythoner.com/tag/%e5%ae%89%e5%85%a8" class="tag-link-25 tag-link-position-27" title="3个话题" style="font-size: 11pt;">安全</a>
<a href="http://www.pythoner.com/tag/%e5%ae%89%e8%a3%85" class="tag-link-58 tag-link-position-28" title="2个话题" style="font-size: 9.8pt;">安装</a>
<a href="http://www.pythoner.com/tag/%e6%80%9d%e7%bb%b4%e5%af%bc%e5%9b%be" class="tag-link-12 tag-link-position-29" title="23个话题" style="font-size: 18.8pt;">思维导图</a>
<a href="http://www.pythoner.com/tag/%e6%95%8f%e6%8d%b7%e5%bc%80%e5%8f%91" class="tag-link-35 tag-link-position-30" title="4个话题" style="font-size: 12pt;">敏捷开发</a>
<a href="http://www.pythoner.com/tag/%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96" class="tag-link-46 tag-link-position-31" title="2个话题" style="font-size: 9.8pt;">数据可视化</a>
<a href="http://www.pythoner.com/tag/%e6%95%b0%e6%8d%ae%e5%ba%93" class="tag-link-140 tag-link-position-32" title="3个话题" style="font-size: 11pt;">数据库</a>
<a href="http://www.pythoner.com/tag/%e6%96%87%e4%bb%b6%e5%af%b9%e6%af%94" class="tag-link-71 tag-link-position-33" title="2个话题" style="font-size: 9.8pt;">文件对比</a>
<a href="http://www.pythoner.com/tag/%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0" class="tag-link-77 tag-link-position-34" title="2个话题" style="font-size: 9.8pt;">机器学习</a>
<a href="http://www.pythoner.com/tag/%e7%99%bb%e5%bd%95" class="tag-link-50 tag-link-position-35" title="2个话题" style="font-size: 9.8pt;">登录</a>
<a href="http://www.pythoner.com/tag/%e7%ae%97%e6%b3%95" class="tag-link-143 tag-link-position-36" title="3个话题" style="font-size: 11pt;">算法</a>
<a href="http://www.pythoner.com/tag/%e7%bf%bb%e8%af%91" class="tag-link-106 tag-link-position-37" title="8个话题" style="font-size: 14.5pt;">翻译</a>
<a href="http://www.pythoner.com/tag/%e8%84%9a%e6%9c%ac" class="tag-link-66 tag-link-position-38" title="2个话题" style="font-size: 9.8pt;">脚本</a>
<a href="http://www.pythoner.com/tag/%e8%87%aa%e5%8a%a8%e8%a1%a5%e5%85%a8" class="tag-link-74 tag-link-position-39" title="2个话题" style="font-size: 9.8pt;">自动补全</a>
<a href="http://www.pythoner.com/tag/%e8%ae%ba%e5%9d%9b" class="tag-link-51 tag-link-position-40" title="2个话题" style="font-size: 9.8pt;">论坛</a>
<a href="http://www.pythoner.com/tag/%e8%ae%be%e8%ae%a1" class="tag-link-114 tag-link-position-41" title="3个话题" style="font-size: 11pt;">设计</a>
<a href="http://www.pythoner.com/tag/%e8%af%ad%e6%b3%95%e9%ab%98%e4%ba%ae" class="tag-link-75 tag-link-position-42" title="2个话题" style="font-size: 9.8pt;">语法高亮</a>
<a href="http://www.pythoner.com/tag/%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0" class="tag-link-11 tag-link-position-43" title="28个话题" style="font-size: 19.6pt;">读书笔记</a>
<a href="http://www.pythoner.com/tag/%e8%bd%af%e4%bb%b6%e5%b7%a5%e7%a8%8b" class="tag-link-36 tag-link-position-44" title="2个话题" style="font-size: 9.8pt;">软件工程</a>
<a href="http://www.pythoner.com/tag/%e9%85%8d%e7%bd%ae%e7%ae%a1%e7%90%86" class="tag-link-54 tag-link-position-45" title="2个话题" style="font-size: 9.8pt;">配置管理</a></div>
</div>
<div class="side_box widget_archive" id="archives-2">
<h3 class="side_title">文章归档</h3>
		<ul>
			<li><a href="http://www.pythoner.com/date/2016/06">2016年六月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2015/03">2015年三月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2015/02">2015年二月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2014/12">2014年十二月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2014/07">2014年七月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2014/06">2014年六月</a>&nbsp;(2)</li>
	<li><a href="http://www.pythoner.com/date/2014/03">2014年三月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2014/01">2014年一月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2013/12">2013年十二月</a>&nbsp;(6)</li>
	<li><a href="http://www.pythoner.com/date/2013/11">2013年十一月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2013/10">2013年十月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2013/09">2013年九月</a>&nbsp;(1)</li>
	<li><a href="http://www.pythoner.com/date/2013/08">2013年八月</a>&nbsp;(5)</li>
	<li><a href="http://www.pythoner.com/date/2013/07">2013年七月</a>&nbsp;(12)</li>
	<li><a href="http://www.pythoner.com/date/2013/06">2013年六月</a>&nbsp;(3)</li>
	<li><a href="http://www.pythoner.com/date/2013/05">2013年五月</a>&nbsp;(8)</li>
	<li><a href="http://www.pythoner.com/date/2013/04">2013年四月</a>&nbsp;(3)</li>
	<li><a href="http://www.pythoner.com/date/2013/03">2013年三月</a>&nbsp;(5)</li>
	<li><a href="http://www.pythoner.com/date/2013/02">2013年二月</a>&nbsp;(13)</li>
	<li><a href="http://www.pythoner.com/date/2013/01">2013年一月</a>&nbsp;(15)</li>
	<li><a href="http://www.pythoner.com/date/2012/12">2012年十二月</a>&nbsp;(1)</li>
		</ul>
		</div>
<div class="side_box widget_categories" id="categories-2">
<h3 class="side_title">分类目录</h3>
		<ul>
	<li class="cat-item cat-item-13"><a href="http://www.pythoner.com/category/wordpress">WordPress</a> (4)
</li>
	<li class="cat-item cat-item-79"><a href="http://www.pythoner.com/category/%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f">操作系统</a> (5)
<ul class="children">
	<li class="cat-item cat-item-64"><a href="http://www.pythoner.com/category/%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f/linux">Linux</a> (5)
</li>
</ul>
</li>
	<li class="cat-item cat-item-33"><a href="http://www.pythoner.com/category/%e6%95%b0%e6%8d%ae%e5%ba%93">数据库</a> (2)
<ul class="children">
	<li class="cat-item cat-item-102"><a href="http://www.pythoner.com/category/%e6%95%b0%e6%8d%ae%e5%ba%93/mongodb">MongoDB</a> (1)
</li>
	<li class="cat-item cat-item-84"><a href="http://www.pythoner.com/category/%e6%95%b0%e6%8d%ae%e5%ba%93/mysql">MySQL</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-107"><a href="http://www.pythoner.com/category/%e7%94%a8%e6%88%b7%e4%bd%93%e9%aa%8c">用户体验</a> (1)
</li>
	<li class="cat-item cat-item-78"><a href="http://www.pythoner.com/category/%e7%ae%97%e6%b3%95">算法</a> (1)
</li>
	<li class="cat-item cat-item-2"><a href="http://www.pythoner.com/category/programming-language">编程语言</a> (43)
<ul class="children">
	<li class="cat-item cat-item-56"><a href="http://www.pythoner.com/category/programming-language/android">Android</a> (1)
</li>
	<li class="cat-item cat-item-90"><a href="http://www.pythoner.com/category/programming-language/latex">LaTeX</a> (1)
</li>
	<li class="cat-item cat-item-4"><a href="http://www.pythoner.com/category/programming-language/python">python</a> (40)
	<ul class="children">
	<li class="cat-item cat-item-101"><a href="http://www.pythoner.com/category/programming-language/python/tornado">Tornado</a> (11)
</li>
	</ul>
</li>
	<li class="cat-item cat-item-72"><a href="http://www.pythoner.com/category/programming-language/shell-programming-language">shell</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.pythoner.com/category/note">读书笔记</a> (28)
</li>
		</ul>
</div>
<div class="side_box widget_links" id="linkcat-0">
<h3 class="side_title">书签</h3>

	<ul class="xoxo blogroll">
<li><a href="http://blog.coocla.org/" target="_blank">Coocla</a></li>
<li><a href="http://www.findspace.name/">FindSpace</a></li>

	</ul>
</div>

</div>
<div id="side_middle" class="clearfix">
 <div id="side_left">
   </div>
 <div id="side_right">
   </div>
</div>
<div id="side_bottom">
 <div class="side_box widget_meta" id="meta-2">
<h3 class="side_title">功能</h3>
			<ul>
						<li><a href="http://www.pythoner.com/wp-login.php">登录</a></li>
			<li><a href="http://www.pythoner.com/feed">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.pythoner.com/comments/feed">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>			</ul>
			</div>
</div>

  </div>
  
  <div id="footer">
   <ul id="copyright">
    <li>版权所有 ©&nbsp; <a href="http://www.pythoner.com/">Pythoner</a></li>
    <li>主题由 <a class="target_blank" href="http://www.mono-lab.net/" target="_blank">mono-lab</a> 设计 <a class="target_blank" href="http://pythoner.com/" target="_blank">你像从前一样</a> 修改</li>
    <li>由 <a class="target_blank" href="http://wordpress.org/" target="_blank">WordPress</a> 强力驱动</li>
    <li class="last"><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253420103'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s6.cnzz.com/z_stat.php%3Fid%3D1253420103' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_1253420103"><a href="http://www.cnzz.com/stat/website.php?web_id=1253420103" target="_blank" title="站长统计">站长统计</a></span><script src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/z_stat.php" type="text/javascript"></script><script src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/core.php" charset="utf-8" type="text/javascript"></script></li>
   </ul>
  </div>

 </div><!-- END #main_content -->


  <p id="return_top" style="display: none;"><a href="http://www.pythoner.com/283.html#header">return top</a></p>
 
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/form.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/www.pythoner.com\/wp-admin\/admin-ajax.php","post_id":"283"};
/* ]]> */
</script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/postviews-cache.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/jquery.sonar.min.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/lazy-load.js"></script>
<script type="text/javascript" src="./《Introduction to Tornado》中文翻译计划——第四章：数据库 _ Pythoner_files/wp-embed.min.js"></script>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=2&amp;pos=right&amp;uid=1482744"></script>

<script type="text/javascript">
var bds_config={"bdTop":200};
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>
<!-- Baidu Button END -->



<!-- Dynamic page generated in 1.442 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2016-09-30 17:11:40 -->

<!-- super cache --></body></html>